<!DOCTYPE html>
<html lang="en">
<head>
    <title>CHANGELOG.md</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
<link rel="stylesheet" href="/css/reset.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/panel.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/main.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/github.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<script src="/js/jquery-3.5.1.min.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/main.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/highlight.pack.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/turbolinks.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/search_index.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/searcher.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/panel/tree.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/searchdoc.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>

<meta name="data-rel-prefix" content="/">
<meta name="data-tree-keys" content='[]'>

</head>

<body>
    <a class="sr-only sr-only-focusable" href="#content" data-turbolinks="false">Skip to Content</a>
    <a class="sr-only sr-only-focusable" href="#search" data-turbolinks="false">Skip to Search</a>

    <input type="checkbox" id="hamburger" class="panel_checkbox">
<label class="panel_mobile_button" for="hamburger"><span></span> Menu</label>
<nav class="panel panel_tree" id="panel" data-turbolinks-permanent>
  <div class="header">
    <input type="text" placeholder="Search (/) for a class, method, ..." autosave="searchdoc" results="10" id="search" autocomplete="off" tabindex="-1" />
    <label class="panel_mobile_button_close" for="hamburger"><span></span> Close</label>
  </div>
  <div class="tree">
    <ul>
    </ul>
  </div>
  <div class="result">
    <ul>
    </ul>
  </div>
  <a href="links.html" id="links">index</a>
</nav>


    <div class="banner">
        
        <h2>
            CHANGELOG.md
        </h2>
        <ul class="files">
            
            <li>
                rails/activesupport/CHANGELOG.md
                
                    <a href="https://github.com/rails/rails/blob/7b55c452b7d9a295d148ff882e0197cd139a9f8f/activesupport/CHANGELOG.md" target="_blank" class="github_url">on GitHub</a>
                
            </li>
            <li>Last modified: 2024-05-24 23:57:11 +0300</li>
        </ul>
    </div>

    <main id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<h2 id="label-Rails+7.0.8.3+-28May+17-2C+2024-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.8.3 (May 17, 2024)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+7.0.8.2+-28May+16-2C+2024-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.8.2 (May 16, 2024)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+7.0.8.1+-28February+21-2C+2024-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.8.1 (February 21, 2024)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+7.0.8+-28September+09-2C+2023-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.8 (September 09, 2023)</h2>
<ul><li>
<p>Fix <code>TimeWithZone</code> still using deprecated <code>#to_s</code> when <code>ENV</code> or <code>config</code> to disable it are set.</p>

<p><em>Hartley McGuire</em></p>
</li><li>
<p>Fix CacheStore#write_multi when using a distributed Redis cache with a connection pool.</p>

<p>Fixes <a href="https://github.com/rails/rails/issues/48938">#48938</a>.</p>

<p><em>Jonathan del Strother</em></p>
</li></ul>

<h2 id="label-Rails+7.0.7.2+-28August+22-2C+2023-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.7.2 (August 22, 2023)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+7.0.7.1+-28August+22-2C+2023-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.7.1 (August 22, 2023)</h2>
<ul><li>
<p>Use a temporary file for storing unencrypted files while editing</p>

<p>[CVE-2023-38037]</p>
</li></ul>

<h2 id="label-Rails+7.0.7+-28August+09-2C+2023-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.7 (August 09, 2023)</h2>
<ul><li>
<p>Fix <code>Cache::NullStore</code> with local caching for repeated reads.</p>

<p><em>fatkodima</em></p>
</li><li>
<p>Fix <code>to_s</code> with no arguments not respecting custom <code>:default</code> formats</p>

<p><em>Hartley McGuire</em></p>
</li><li>
<p>Fix <code>ActiveSupport::Inflector.humanize(nil)</code> raising <code>NoMethodError: undefined method `end_with?&#39; for nil:NilClass</code>.</p>

<p><em>James Robinson</em></p>
</li><li>
<p>Fix <code>Enumerable#sum</code> for <code>Enumerator#lazy</code>.</p>

<p><em>fatkodima</em>, <em>Matthew Draper</em>, <em>Jonathan Hefner</em></p>
</li><li>
<p>Improve error message when EventedFileUpdateChecker is used without a compatible version of the Listen gem</p>

<p><em>Hartley McGuire</em></p>
</li></ul>

<h2 id="label-Rails+7.0.6+-28June+29-2C+2023-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.6 (June 29, 2023)</h2>
<ul><li>
<p>Fix <code>EncryptedConfiguration</code> returning incorrect values for some <code>Hash</code> methods</p>

<p><em>Hartley McGuire</em></p>
</li><li>
<p>Fix arguments being destructed <code>Enumerable#many?</code> with block.</p>

<p><em>Andrew Novoselac</em></p>
</li><li>
<p>Fix humanize for strings ending with id.</p>

<p><em>fatkodima</em></p>
</li></ul>

<h2 id="label-Rails+7.0.5.1+-28June+26-2C+2023-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.5.1 (June 26, 2023)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+7.0.5+-28May+24-2C+2023-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.5 (May 24, 2023)</h2>
<ul><li>
<p>Fixes TimeWithZone ArgumentError.</p>

<p><em>Niklas Häusele</em></p>
</li></ul>

<h2 id="label-Rails+7.0.4.3+-28March+13-2C+2023-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.4.3 (March 13, 2023)</h2>
<ul><li>
<p>Implement SafeBuffer#bytesplice</p>

<p>[CVE-2023-28120]</p>
</li></ul>

<h2 id="label-Rails+7.0.4.2+-28January+24-2C+2023-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.4.2 (January 24, 2023)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+7.0.4.1+-28January+17-2C+2023-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.4.1 (January 17, 2023)</h2>
<ul><li>
<p>Avoid regex backtracking in Inflector.underscore</p>

<p>[CVE-2023-22796]</p>
</li></ul>

<h2 id="label-Rails+7.0.4+-28September+09-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.4 (September 09, 2022)</h2>
<ul><li>
<p>Ensure <code>ActiveSupport::Testing::Isolation::Forking</code> closes pipes</p>

<p>Previously, <code>Forking.run_in_isolation</code> opened two ends of a pipe. The fork process closed the read end, wrote to it, and then terminated (which presumably closed the file descriptors on its end). The parent process closed the write end, read from it, and returned, never closing the read end.</p>

<p>This resulted in an accumulation of open file descriptors, which could cause errors if the limit is reached.</p>

<p><em>Sam Bostock</em></p>
</li><li>
<p>Redis cache store is now compatible with redis-rb 5.0.</p>

<p><em>Jean Boussier</em></p>
</li><li>
<p>Fix <code>NoMethodError</code> on custom <code>ActiveSupport::Deprecation</code> behavior.</p>

<p><code>ActiveSupport::Deprecation.behavior=</code> was supposed to accept any object that responds to <code>call</code>, but in fact its internal implementation assumed that this object could respond to <code>arity</code>, so it was restricted to only <code>Proc</code> objects.</p>

<p>This change removes this <code>arity</code> restriction of custom behaviors.</p>

<p><em>Ryo Nakamura</em></p>
</li></ul>

<h2 id="label-Rails+7.0.3.1+-28July+12-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.3.1 (July 12, 2022)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+7.0.3+-28May+09-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.3 (May 09, 2022)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+7.0.2.4+-28April+26-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.2.4 (April 26, 2022)</h2>
<ul><li>
<p>Fix and add protections for XSS in <code>ActionView::Helpers</code> and <code>ERB::Util</code>.</p>

<p>Add the method <code>ERB::Util.xml_name_escape</code> to escape dangerous characters in names of tags and names of attributes, following the specification of XML.</p>

<p><em>Álvaro Martín Fraguas</em></p>
</li></ul>

<h2 id="label-Rails+7.0.2.3+-28March+08-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.2.3 (March 08, 2022)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+7.0.2.2+-28February+11-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.2.2 (February 11, 2022)</h2>
<ul><li>
<p>Fix Reloader method signature to work with the new Executor signature</p>
</li></ul>

<h2 id="label-Rails+7.0.2.1+-28February+11-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.2.1 (February 11, 2022)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+7.0.2+-28February+08-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.2 (February 08, 2022)</h2>
<ul><li>
<p>Fix <code>ActiveSupport::EncryptedConfiguration</code> to be compatible with Psych 4</p>

<p><em>Stephen Sugden</em></p>
</li><li>
<p>Improve <code>File.atomic_write</code> error handling.</p>

<p><em>Daniel Pepper</em></p>
</li></ul>

<h2 id="label-Rails+7.0.1+-28January+06-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.1 (January 06, 2022)</h2>
<ul><li>
<p>Fix <code>Class#descendants</code> and <code>DescendantsTracker#descendants</code> compatibility with Ruby 3.1.</p>

<p>{The native <code>Class#descendants</code> was reverted prior to Ruby 3.1 release}[https://bugs.ruby-lang.org/issues/14394#note-33], but <code>Class#subclasses</code> was kept, breaking the feature detection.</p>

<p><em>Jean Boussier</em></p>
</li></ul>

<h2 id="label-Rails+7.0.0+-28December+15-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.0 (December 15, 2021)</h2>
<ul><li>
<p>Fix <code>ActiveSupport::Duration.build</code> to support negative values.</p>

<p>The algorithm to collect the <code>parts</code> of the <code>ActiveSupport::Duration</code> ignored the sign of the <code>value</code> and accumulated incorrect part values. This impacted <code>ActiveSupport::Duration#sum</code> (which is dependent on <code>parts</code>) but not <code>ActiveSupport::Duration#eql?</code> (which is dependent on <code>value</code>).</p>

<p><em>Caleb Buxton</em>, <em>Braden Staudacher</em></p>
</li></ul>

<h2 id="label-Rails+7.0.0.rc3+-28December+14-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.0.rc3 (December 14, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+7.0.0.rc2+-28December+14-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.0.rc2 (December 14, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+7.0.0.rc1+-28December+06-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.0.rc1 (December 06, 2021)</h2>
<ul><li>
<p>Deprecate passing a format to <code>#to_s</code> in favor of <code>#to_formatted_s</code> in <code>Array</code>, <code>Range</code>, <code>Date</code>, <code>DateTime</code>, <code>Time</code>, <code>BigDecimal</code>, <code>Float</code> and, <code>Integer</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Document <code>ActiveSupport::Testing::Deprecation</code>.</p>

<p><em>Sam Bostock &amp; Sam Jordan</em></p>
</li><li>
<p>Add <code>Pathname#existence</code>.</p>

<pre><code>Pathname.new(&quot;file&quot;).existence&amp;.read
</code></pre>

<p><em>Timo Schilling</em></p>
</li><li>
<p>Remove deprecate <code>ActiveSupport::Multibyte::Unicode.default_normalization_form</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated support to use <code>Range#include?</code> to check the inclusion of a value in a date time range is deprecated.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated <code>URI.parser</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated <code>config.active_support.use_sha1_digests</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Invoking <code>Object#with_options</code> without a <code>&amp;block</code> argument returns the <code>ActiveSupport::OptionMerger</code> instance.</p>

<p><em>Sean Doyle</em></p>
</li><li>
<p><code>Rails.application.executor</code> hooks can now be called around every test</p>

<p>This helps to better simulate request or job local state being reset around tests and prevents state leaking from one test to another.</p>

<p>However it requires the executor hooks executed in the test environment to be re-entrant.</p>

<p>To enable this, set <code>config.active_support.executor_around_test_case = true</code> (this is the default in <a href="../../../classes/Rails.html"><code>Rails</code></a> 7).</p>

<p><em>Jean Boussier</em></p>
</li><li>
<p><code>ActiveSupport::DescendantsTracker</code> now mostly delegate to <code>Class#descendants</code> on Ruby 3.1</p>

<p>Ruby now provides a fast <code>Class#descendants</code> making <code>ActiveSupport::DescendantsTracker</code> mostly useless.</p>

<p>As a result the following methods are deprecated:</p>
<ul><li>
<p><code>ActiveSupport::DescendantsTracker.direct_descendants</code></p>
</li><li>
<p><code>ActiveSupport::DescendantsTracker#direct_descendants</code></p>
</li></ul>

<p><em>Jean Boussier</em></p>
</li><li>
<p>Fix the <code>Digest::UUID.uuid_from_hash</code> behavior for namespace IDs that are different from the ones defined on <code>Digest::UUID</code>.</p>

<p>The new behavior will be enabled by setting the <code>config.active_support.use_rfc4122_namespaced_uuids</code> option to <code>true</code> and is the default for new apps.</p>

<p>The old behavior is the default for upgraded apps and will output a deprecation warning every time a value that is different than one of the constants defined on the <code>Digest::UUID</code> extension is used as the namespace ID.</p>

<p><em>Alex Robbin</em>, <em>Erich Soares Machado</em>, <em>Eugene Kenny</em></p>
</li><li>
<p><code>ActiveSupport::Inflector::Inflections#clear(:acronyms)</code> is now supported, and <code>inflector.clear</code> / <code>inflector.clear(:all)</code> also clears acronyms.</p>

<p><em>Alex Ghiculescu</em>, <em>Oliver Peate</em></p>
</li></ul>

<h2 id="label-Rails+7.0.0.alpha2+-28September+15-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.0.alpha2 (September 15, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+7.0.0.alpha1+-28September+15-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0.0.alpha1 (September 15, 2021)</h2>
<ul><li>
<p><code>ActiveSupport::Dependencies</code> no longer installs a <code>const_missing</code> hook. Before this, you could push to the autoload paths and have constants autoloaded. This feature, known as the <code>classic</code> autoloader, has been removed.</p>

<p><em>Xavier Noria</em></p>
</li><li>
<p>Private internal classes of <code>ActiveSupport::Dependencies</code> have been deleted, like <code>ActiveSupport::Dependencies::Reference</code>, <code>ActiveSupport::Dependencies::Blamable</code>, and others.</p>

<p><em>Xavier Noria</em></p>
</li><li>
<p>The private API of <code>ActiveSupport::Dependencies</code> has been deleted. That includes methods like <code>hook!</code>, <code>unhook!</code>, <code>depend_on</code>, <code>require_or_load</code>, <code>mechanism</code>, and many others.</p>

<p><em>Xavier Noria</em></p>
</li><li>
<p>Improves the performance of <code>ActiveSupport::NumberHelper</code> formatters by avoiding the use of exceptions as flow control.</p>

<p><em>Mike Dalessio</em></p>
</li><li>
<p>Removed rescue block from <code>ActiveSupport::Cache::RedisCacheStore#handle_exception</code></p>

<p>Previously, if you provided a <code>error_handler</code> to <code>redis_cache_store</code>, any errors thrown by the error handler would be rescued and logged only. Removed the <code>rescue</code> clause from <code>handle_exception</code> to allow these to be thrown.</p>

<p><em>Nicholas A. Stuart</em></p>
</li><li>
<p>Allow entirely opting out of deprecation warnings.</p>

<p>Previously if you did <code>app.config.active_support.deprecation = :silence</code>, some work would still be done on each call to <code>ActiveSupport::Deprecation.warn</code>. In very hot paths, this could cause performance issues.</p>

<p>Now, you can make <code>ActiveSupport::Deprecation.warn</code> a no-op:</p>

<pre><code>config.active_support.report_deprecations = false
</code></pre>

<p>This is the default in production for new apps. It is the equivalent to:</p>

<pre><code>config.active_support.deprecation = :silence
config.active_support.disallowed_deprecation = :silence
</code></pre>

<p>but will take a more optimised code path.</p>

<p><em>Alex Ghiculescu</em></p>
</li><li>
<p>Faster tests by parallelizing only when overhead is justified by the number of them.</p>

<p>Running tests in parallel adds overhead in terms of database setup and fixture loading. Now, <a href="../../../classes/Rails.html"><code>Rails</code></a> will only parallelize test executions when there are enough tests to make it worth it.</p>

<p>This threshold is 50 by default, and is configurable via config setting in your test.rb:</p>

<pre><code>config.active_support.test_parallelization_threshold = 100
</code></pre>

<p>It's also configurable at the test case level:</p>

<pre><code>class ActiveSupport::TestCase
  parallelize threshold: 100
end
</code></pre>

<p><em>Jorge Manrubia</em></p>
</li><li>
<p>OpenSSL constants are now used for <a href="../../../classes/Digest.html"><code>Digest</code></a> computations.</p>

<p><em>Dirkjan Bussink</em></p>
</li><li>
<p><code>TimeZone.iso8601</code> now accepts valid ordinal values similar to Ruby’s <code>Date._iso8601</code> method. A valid ordinal value will be converted to an instance of <code>TimeWithZone</code> using the <code>:year</code> and <code>:yday</code> fragments returned from <code>Date._iso8601</code>.</p>

<pre><code>twz = ActiveSupport::TimeZone[&quot;Eastern Time (US &amp; Canada)&quot;].iso8601(&quot;21087&quot;)
twz.to_a[0, 6] == [0, 0, 0, 28, 03, 2021]
</code></pre>

<p><em>Steve Laing</em></p>
</li><li>
<p><code>Time#change</code> and methods that call it (e.g. <code>Time#advance</code>) will now return a <code>Time</code> with the timezone argument provided, if the caller was initialized with a timezone argument.</p>

<p>Fixes <a href="https://github.com/rails/rails/issues/42467">#42467</a>.</p>

<p><em>Alex Ghiculescu</em></p>
</li><li>
<p>Allow serializing any module or class to JSON by name.</p>

<p><em>Tyler Rick</em>, <em>Zachary Scott</em></p>
</li><li>
<p>Raise <code>ActiveSupport::EncryptedFile::MissingKeyError</code> when the <code>RAILS_MASTER_KEY</code> environment variable is blank (e.g. <code>&quot;&quot;</code>).</p>

<p><em>Sunny Ripert</em></p>
</li><li>
<p>The <code>from:</code> option is added to <code>ActiveSupport::TestCase#assert_no_changes</code>.</p>

<p>It permits asserting on the initial value that is expected not to change.</p>

<pre><code>assert_no_changes -&gt; { Status.all_good? }, from: true do
  post :create, params: { status: { ok: true } }
end
</code></pre>

<p><em>George Claghorn</em></p>
</li><li>
<p>Deprecate <code>ActiveSupport::SafeBuffer</code>‘s incorrect implicit conversion of objects into string.</p>

<p>Except for a few methods like <code>String#%</code>, objects must implement <code>#to_str</code> to be implicitly converted to a <a href="../../../classes/String.html"><code>String</code></a> in string operations. In some circumstances <code>ActiveSupport::SafeBuffer</code> was incorrectly calling the explicit conversion method (<code>#to_s</code>) on them. This behavior is now deprecated.</p>

<p><em>Jean Boussier</em></p>
</li><li>
<p>Allow nested access to keys on <code>Rails.application.credentials</code>.</p>

<p>Previously only top level keys in <code>credentials.yml.enc</code> could be accessed with method calls. Now any key can.</p>

<p>For example, given these secrets:</p>

<pre><code>aws:
  access_key_id: 123
  secret_access_key: 345
</code></pre>

<p><code>Rails.application.credentials.aws.access_key_id</code> will now return the same thing as <code>Rails.application.credentials.aws[:access_key_id]</code>.</p>

<p><em>Alex Ghiculescu</em></p>
</li><li>
<p>Added a faster and more compact <code>ActiveSupport::Cache</code> serialization format.</p>

<p>It can be enabled with <code>config.active_support.cache_format_version = 7.0</code> or <code>config.load_defaults 7.0</code>. Regardless of the configuration Active Support 7.0 can read cache entries serialized by Active Support 6.1 which allows to upgrade without invalidating the cache. However <a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1 can't read the new format, so all readers must be upgraded before the new format is enabled.</p>

<p><em>Jean Boussier</em></p>
</li><li>
<p>Add <code>Enumerable#sole</code>, per <code>ActiveRecord::FinderMethods#sole</code>. Returns the sole item of the enumerable, raising if no items are found, or if more than one is.</p>

<p><em>Asherah Connor</em></p>
</li><li>
<p>Freeze <code>ActiveSupport::Duration#parts</code> and remove writer methods.</p>

<p>Durations are meant to be value objects and should not be mutated.</p>

<p><em>Andrew White</em></p>
</li><li>
<p>Fix <code>ActiveSupport::TimeZone#utc_to_local</code> with fractional seconds.</p>

<p>When <code>utc_to_local_returns_utc_offset_times</code> is false and the time instance had fractional seconds the new UTC time instance was out by a factor of 1,000,000 as the <code>Time.utc</code> constructor takes a usec value and not a fractional second value.</p>

<p><em>Andrew White</em></p>
</li><li>
<p>Add <code>expires_at</code> argument to <code>ActiveSupport::Cache</code> <code>write</code> and <code>fetch</code> to set a cache entry TTL as an absolute time.</p>

<pre><code>Rails.cache.write(key, value, expires_at: Time.now.at_end_of_hour)
</code></pre>

<p><em>Jean Boussier</em></p>
</li><li>
<p>Deprecate <code>ActiveSupport::TimeWithZone.name</code> so that from <a href="../../../classes/Rails.html"><code>Rails</code></a> 7.1 it will use the default implementation.</p>

<p><em>Andrew White</em></p>
</li><li>
<p>Deprecates <a href="../../../classes/Rails.html"><code>Rails</code></a> custom <code>Enumerable#sum</code> and <code>Array#sum</code> in favor of Ruby's native implementation which is considerably faster.</p>

<p>Ruby requires an initializer for non-numeric type as per examples below:</p>

<pre><code>%w[foo bar].sum(&#39;&#39;)
# instead of %w[foo bar].sum

[[1, 2], [3, 4, 5]].sum([])
# instead of [[1, 2], [3, 4, 5]].sum
</code></pre>

<p><em>Alberto Mota</em></p>
</li><li>
<p>Tests parallelization is now disabled when running individual files to prevent the setup overhead.</p>

<p>It can still be enforced if the environment variable <code>PARALLEL_WORKERS</code> is present and set to a value greater than 1.</p>

<p><em>Ricardo Díaz</em></p>
</li><li>
<p>Fix proxying keyword arguments in <code>ActiveSupport::CurrentAttributes</code>.</p>

<p><em>Marcin Kołodziej</em></p>
</li><li>
<p>Add <code>Enumerable#maximum</code> and <code>Enumerable#minimum</code> to easily calculate the maximum or minimum from extracted elements of an enumerable.</p>

<pre><code>payments = [Payment.new(5), Payment.new(15), Payment.new(10)]

payments.minimum(:price) # =&gt; 5
payments.maximum(:price) # =&gt; 15
</code></pre>

<p>This also allows passing enumerables to <code>fresh_when</code> and <code>stale?</code> in Action Controller. See PR <a href="https://github.com/rails/rails/pull/41404">#41404</a> for an example.</p>

<p><em>Ayrton De Craene</em></p>
</li><li>
<p><code>ActiveSupport::Cache::MemCacheStore</code> now accepts an explicit <code>nil</code> for its <code>addresses</code> argument.</p>

<pre><code>config.cache_store = :mem_cache_store, nil

# is now equivalent to

config.cache_store = :mem_cache_store

# and is also equivalent to

config.cache_store = :mem_cache_store, ENV[&quot;MEMCACHE_SERVERS&quot;] || &quot;localhost:11211&quot;

# which is the fallback behavior of Dalli
</code></pre>

<p>This helps those migrating from <code>:dalli_store</code>, where an explicit <code>nil</code> was permitted.</p>

<p><em>Michael Overmeyer</em></p>
</li><li>
<p>Add <code>Enumerable#in_order_of</code> to put an <a href="../../../classes/Enumerable.html"><code>Enumerable</code></a> in a certain order by a key.</p>

<p><em>DHH</em></p>
</li><li>
<p><code>ActiveSupport::Inflector.camelize</code> behaves expected when provided a symbol <code>:upper</code> or <code>:lower</code> argument. Matches <code>String#camelize</code> behavior.</p>

<p><em>Alex Ghiculescu</em></p>
</li><li>
<p>Raises an <code>ArgumentError</code> when the first argument of <code>ActiveSupport::Notification.subscribe</code> is invalid.</p>

<p><em>Vipul A M</em></p>
</li><li>
<p><code>HashWithIndifferentAccess#deep_transform_keys</code> now returns a <code>HashWithIndifferentAccess</code> instead of a <code>Hash</code>.</p>

<p><em>Nathaniel Woodthorpe</em></p>
</li><li>
<p>Consume dalli’s <code>cache_nils</code> configuration as <code>ActiveSupport::Cache</code>‘s <code>skip_nil</code> when using <code>MemCacheStore</code>.</p>

<p><em>Ritikesh G</em></p>
</li><li>
<p>Add <code>RedisCacheStore#stats</code> method similar to <code>MemCacheStore#stats</code>. Calls <code>redis#info</code> internally.</p>

<p><em>Ritikesh G</em></p>
</li></ul>

<p>Please check <a href="https://github.com/rails/rails/blob/6-1-stable/activesupport/CHANGELOG.md">6-1-stable</a> for previous changes.</p>

    </div>
  


  


  
  


  


  

  



  

    

    

    


    


    <!-- Methods -->
    
    
    
  
</div>

    </main>
  </body>
</html>
