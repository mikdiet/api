<!DOCTYPE html>
<html lang="en">
<head>
    <title>Prism::ParseResult::Comments</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
<link rel="stylesheet" href="/css/reset.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/panel.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/main.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/github.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<script src="/js/jquery-3.5.1.min.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/main.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/highlight.pack.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/turbolinks.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/search_index.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/searcher.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/panel/tree.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/searchdoc.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>

<meta name="data-rel-prefix" content="/">
<meta name="data-tree-keys" content='["Prism", "ParseResult", "Comments"]'>


    <meta property="og:title" value="Prism::ParseResult::Comments">

  
    
    <meta name="description" content="When we’ve parsed the source, we have both the syntax tree and the list of comments that we found in the source.">
    <meta property="og:description" content="When we’ve parsed the source, we have both the syntax tree and the list of comments that we found in the source.">
  

    <meta name="keywords" content="Prism::ParseResult::Comments class, new, attach!">
</head>

<body>
    <a class="sr-only sr-only-focusable" href="#content" data-turbolinks="false">Skip to Content</a>
    <a class="sr-only sr-only-focusable" href="#search" data-turbolinks="false">Skip to Search</a>

    <input type="checkbox" id="hamburger" class="panel_checkbox">
<label class="panel_mobile_button" for="hamburger"><span></span> Menu</label>
<nav class="panel panel_tree" id="panel" data-turbolinks-permanent>
  <div class="header">
    <input type="text" placeholder="Search (/) for a class, method, ..." autosave="searchdoc" results="10" id="search" autocomplete="off" tabindex="-1" />
    <label class="panel_mobile_button_close" for="hamburger"><span></span> Close</label>
  </div>
  <div class="tree">
    <ul>
    </ul>
  </div>
  <div class="result">
    <ul>
    </ul>
  </div>
  <a href="links.html" id="links">index</a>
</nav>


    <div class="banner">
        
        <h2>
            <span class="type">Class</span>
            Prism::ParseResult::Comments
            
                <span class="parent">&lt;
                    
                    <a href="../../Object.html">Object</a>
                    
                </span>
            
        </h2>
        <ul class="files">
            
            <li><a href="../../../files/ruby/lib/prism/parse_result/comments_rb.html">ruby/lib/prism/parse_result/comments.rb</a></li>
            
        </ul>
    </div>

    <main id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>When we’ve parsed the source, we have both the syntax tree and the list of comments that we found in the source. This class is responsible for walking the tree and finding the nearest location to attach each comment.</p>

<p>It does this by first finding the nearest locations to each comment. Locations can either come from nodes directly or from location fields on nodes. For example, a ‘ClassNode` has an overall location encompassing the entire class, but it also has a location for the `class` keyword.</p>

<p>Once the nearest locations are found, it determines which one to attach to. If it’s a trailing comment (a comment on the same line as other source code), it will favor attaching to the nearest location that occurs before the comment. Otherwise it will favor attaching to the nearest location that is after the comment.</p>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>A</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-attach-21">attach!</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    
      <!-- Section attributes -->
      <h2 class="sectiontitle">Attributes</h2>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>parse_result</td>
            <td class='attr-desc'><p>The parse result that we are attaching comments to.</p></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <h2 class="sectiontitle">Class Public methods</h2>
      
        <div class="method">
          <h3 class="title method-title" id="method-c-new">
            
              <b>new</b>(parse_result)
            
            <a href="../../../classes/Prism/ParseResult/Comments.html#method-c-new" name="method-c-new" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Create a new <a href="Comments.html"><code>Comments</code></a> object that will attach comments to the given parse result.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7b55c452b7d9a295d148ff882e0197cd139a9f8f/lib/prism/parse_result/comments.rb#L78" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/prism/parse_result/comments.rb, line 78</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">parse_result</span>)
  <span class="ruby-ivar">@parse_result</span> = <span class="ruby-identifier">parse_result</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
      
    
      <h2 class="sectiontitle">Instance Public methods</h2>
      
        <div class="method">
          <h3 class="title method-title" id="method-i-attach-21">
            
              <b>attach!</b>()
            
            <a href="../../../classes/Prism/ParseResult/Comments.html#method-i-attach-21" name="method-i-attach-21" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Attach the comments to their respective locations in the tree by mutating the parse result.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-attach-21_source')" id="l_method-i-attach-21_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7b55c452b7d9a295d148ff882e0197cd139a9f8f/lib/prism/parse_result/comments.rb#L84" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-attach-21_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/prism/parse_result/comments.rb, line 84</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">attach!</span>
  <span class="ruby-identifier">parse_result</span>.<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">comment</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">preceding</span>, <span class="ruby-identifier">enclosing</span>, <span class="ruby-identifier">following</span> = <span class="ruby-identifier">nearest_targets</span>(<span class="ruby-identifier">parse_result</span>.<span class="ruby-identifier">value</span>, <span class="ruby-identifier">comment</span>)
    <span class="ruby-identifier">target</span> =
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">comment</span>.<span class="ruby-identifier">trailing?</span>
        <span class="ruby-identifier">preceding</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">following</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">enclosing</span> <span class="ruby-operator">||</span> <span class="ruby-constant">NodeTarget</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">parse_result</span>.<span class="ruby-identifier">value</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-comment"># If a comment exists on its own line, prefer a leading comment.</span>
        <span class="ruby-identifier">following</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">preceding</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">enclosing</span> <span class="ruby-operator">||</span> <span class="ruby-constant">NodeTarget</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">parse_result</span>.<span class="ruby-identifier">value</span>)
      <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">target</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">comment</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
      
    
  
</div>

    </main>
  </body>
</html>
