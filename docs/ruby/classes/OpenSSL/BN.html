<!DOCTYPE html>
<html lang="en">
<head>
    <title>OpenSSL::BN</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
<link rel="stylesheet" href="/css/reset.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/panel.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/main.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/github.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<script src="/js/jquery-3.5.1.min.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/main.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/highlight.pack.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/turbolinks.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/search_index.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/searcher.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/panel/tree.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/searchdoc.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>

<meta name="data-rel-prefix" content="/">
<meta name="data-tree-keys" content='["OpenSSL", "BN"]'>


    <meta property="og:title" value="OpenSSL::BN">

  

    <meta name="keywords" content="OpenSSL::BN class, pretty_print, new, initialize_copy, copy, num_bytes, num_bits, +@, -@, abs, +, -, *, sqr, /, %, mod_add, mod_sub, mod_mul, mod_sqr, mod_sqrt, **, mod_exp, gcd, cmp, ucmp, eql?, hash, ==, zero?, one?, odd?, negative?, rand, rand_range, generate_prime, prime?, prime_fasttest?, set_bit!, clear_bit!, bit_set?, <<, >>, lshift!, rshift!, get_flags, set_flags, to_s, to_i, to_bn, coerce, mod_inverse, <=>, ===, to_int">
</head>

<body>
    <a class="sr-only sr-only-focusable" href="#content" data-turbolinks="false">Skip to Content</a>
    <a class="sr-only sr-only-focusable" href="#search" data-turbolinks="false">Skip to Search</a>

    <input type="checkbox" id="hamburger" class="panel_checkbox">
<label class="panel_mobile_button" for="hamburger"><span></span> Menu</label>
<nav class="panel panel_tree" id="panel" data-turbolinks-permanent>
  <div class="header">
    <input type="text" placeholder="Search (/) for a class, method, ..." autosave="searchdoc" results="10" id="search" autocomplete="off" tabindex="-1" />
    <label class="panel_mobile_button_close" for="hamburger"><span></span> Close</label>
  </div>
  <div class="tree">
    <ul>
    </ul>
  </div>
  <div class="result">
    <ul>
    </ul>
  </div>
  <a href="links.html" id="links">index</a>
</nav>


    <div class="banner">
        
        <h2>
            <span class="type">Class</span>
            OpenSSL::BN
            
                <span class="parent">&lt;
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h2>
        <ul class="files">
            
            <li><a href="../../files/ruby/ext/openssl/lib/openssl/bn_rb.html">ruby/ext/openssl/lib/openssl/bn.rb</a></li>
            
            <li><a href="../../files/ruby/ext/openssl/ossl_c.html">ruby/ext/openssl/ossl.c</a></li>
            
        </ul>
    </div>

    <main id="bodyContent">
        <div id="content">
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>#</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-25">%</a>,
              </li>
            
              
              <li>
                <a href="#method-i-2A">*</a>,
              </li>
            
              
              <li>
                <a href="#method-i-2A-2A">**</a>,
              </li>
            
              
              <li>
                <a href="#method-i-2B">+</a>,
              </li>
            
              
              <li>
                <a href="#method-i-2B-40">+@</a>,
              </li>
            
              
              <li>
                <a href="#method-i-2D">-</a>,
              </li>
            
              
              <li>
                <a href="#method-i-2D-40">-@</a>,
              </li>
            
              
              <li>
                <a href="#method-i-2F">/</a>,
              </li>
            
              
              <li>
                <a href="#method-i-3C-3C">&lt;&lt;</a>,
              </li>
            
              
              <li>
                <a href="#method-i-3C-3D-3E">&lt;=&gt;</a>,
              </li>
            
              
              <li>
                <a href="#method-i-3D-3D">==</a>,
              </li>
            
              
              <li>
                <a href="#method-i-3D-3D-3D">===</a>,
              </li>
            
              
              <li>
                <a href="#method-i-3E-3E">&gt;&gt;</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>A</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-abs">abs</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-bit_set-3F">bit_set?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>C</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-clear_bit-21">clear_bit!</a>,
              </li>
            
              
              <li>
                <a href="#method-i-cmp">cmp</a>,
              </li>
            
              
              <li>
                <a href="#method-i-coerce">coerce</a>,
              </li>
            
              
              <li>
                <a href="#method-i-copy">copy</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>E</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-eql-3F">eql?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>G</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-gcd">gcd</a>,
              </li>
            
              
              <li>
                <a href="#method-c-generate_prime">generate_prime</a>,
              </li>
            
              
              <li>
                <a href="#method-i-get_flags">get_flags</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>H</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-hash">hash</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-initialize_copy">initialize_copy</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>L</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-lshift-21">lshift!</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>M</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-mod_add">mod_add</a>,
              </li>
            
              
              <li>
                <a href="#method-i-mod_exp">mod_exp</a>,
              </li>
            
              
              <li>
                <a href="#method-i-mod_inverse">mod_inverse</a>,
              </li>
            
              
              <li>
                <a href="#method-i-mod_mul">mod_mul</a>,
              </li>
            
              
              <li>
                <a href="#method-i-mod_sqr">mod_sqr</a>,
              </li>
            
              
              <li>
                <a href="#method-i-mod_sqrt">mod_sqrt</a>,
              </li>
            
              
              <li>
                <a href="#method-i-mod_sub">mod_sub</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-negative-3F">negative?</a>,
              </li>
            
              
              <li>
                <a href="#method-c-new">new</a>,
              </li>
            
              
              <li>
                <a href="#method-i-num_bits">num_bits</a>,
              </li>
            
              
              <li>
                <a href="#method-i-num_bytes">num_bytes</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>O</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-odd-3F">odd?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-one-3F">one?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>P</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-pretty_print">pretty_print</a>,
              </li>
            
              
              <li>
                <a href="#method-i-prime-3F">prime?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-prime_fasttest-3F">prime_fasttest?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-rand">rand</a>,
              </li>
            
              
              <li>
                <a href="#method-c-rand_range">rand_range</a>,
              </li>
            
              
              <li>
                <a href="#method-i-rshift-21">rshift!</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-set_bit-21">set_bit!</a>,
              </li>
            
              
              <li>
                <a href="#method-i-set_flags">set_flags</a>,
              </li>
            
              
              <li>
                <a href="#method-i-sqr">sqr</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-to_bn">to_bn</a>,
              </li>
            
              
              <li>
                <a href="#method-i-to_i">to_i</a>,
              </li>
            
              
              <li>
                <a href="#method-i-to_int">to_int</a>,
              </li>
            
              
              <li>
                <a href="#method-i-to_s">to_s</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>U</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-ucmp">ucmp</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>Z</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-zero-3F">zero?</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  
    <!-- Includes -->
    <div class="sectiontitle">Included Modules</div>
    <ul>
      
        <li>
          
            <a href="../Comparable.html">
              Comparable
            </a>
          
        </li>
      
    </ul>
  



  

    

    

    
      <!-- Section constants -->
      <h2 class="sectiontitle">Constants</h2>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class="attr-name">CONSTTIME</td>
            <td>=</td>
            <td class="attr-value">INT2NUM(BN_FLG_CONSTTIME)</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">MALLOCED</td>
            <td>=</td>
            <td class="attr-value">INT2NUM(BN_FLG_MALLOCED)</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">STATIC_DATA</td>
            <td>=</td>
            <td class="attr-value">INT2NUM(BN_FLG_STATIC_DATA)</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
      </table>
    


    


    <!-- Methods -->
    
      <h2 class="sectiontitle">Class Public methods</h2>
      
        <div class="method">
          <h3 class="title method-title" id="method-c-generate_prime">
            
              <b>BN.generate_prime(bits, [, safe [, add [, rem]]]) => bn
</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-c-generate_prime" name="method-c-generate_prime" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Generates a random prime number of bit length <em>bits</em>. If <em>safe</em> is set to <code>true</code>, generates a safe prime. If <em>add</em> is specified, generates a prime that fulfills condition <code>p % add = rem</code>.</p>

<h3 id="method-c-generate_prime-label-Parameters">Parameters</h3>
<ul><li>
<p><em>bits</em> - integer</p>
</li><li>
<p><em>safe</em> - boolean</p>
</li><li>
<p><em>add</em> - <a href="BN.html"><code>BN</code></a></p>
</li><li>
<p><em>rem</em> - <a href="BN.html"><code>BN</code></a></p>
</li></ul>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-generate_prime_source')" id="l_method-c-generate_prime_source">show</a>
                
              </p>
              <div id="method-c-generate_prime_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_s_generate_prime(int argc, VALUE *argv, VALUE klass)
{
    BIGNUM *add = NULL, *rem = NULL, *result;
    int safe = 1, num;
    VALUE vnum, vsafe, vadd, vrem, obj;

    rb_scan_args(argc, argv, &quot;13&quot;, &amp;vnum, &amp;vsafe, &amp;vadd, &amp;vrem);

    num = NUM2INT(vnum);

    if (vsafe == Qfalse) {
        safe = 0;
    }
    if (!NIL_P(vadd)) {
        add = GetBNPtr(vadd);
        rem = NIL_P(vrem) ? NULL : GetBNPtr(vrem);
    }
    obj = NewBN(klass);
    if (!(result = BN_new())) {
        ossl_raise(eBNError, NULL);
    }
    if (!BN_generate_prime_ex(result, num, safe, add, rem, NULL)) {
        BN_free(result);
        ossl_raise(eBNError, NULL);
    }
    SetBN(obj, result);

    return obj;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-c-new">
            
              <b>OpenSSL::BN.new(bn) &rarr; aBN<br />OpenSSL::BN.new(integer) &rarr; aBN<br />OpenSSL::BN.new(string, base = 10) &rarr; aBN
</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-c-new" name="method-c-new" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Construct a new OpenSSL BIGNUM object.</p>

<p>If <code>bn</code> is an <a href="../Integer.html"><code>Integer</code></a> or <a href="BN.html"><code>OpenSSL::BN</code></a>, a new instance of <a href="BN.html"><code>OpenSSL::BN</code></a> representing the same value is returned. See also <a href="../Integer.html#method-i-to_bn"><code>Integer#to_bn</code></a> for the short-hand.</p>

<p>If a <a href="../String.html"><code>String</code></a> is given, the content will be parsed according to <code>base</code>.</p>
<dl class="rdoc-list note-list"><dt><code>string</code>
<dd>
<p>The string to be parsed.</p>
</dd><dt><code>base</code>
<dd>
<p>The format. Must be one of the following:</p>
<ul><li>
<p><code>0</code>  - MPI format. See the man page BN_mpi2bn(3) for details.</p>
</li><li>
<p><code>2</code>  - Variable-length and big-endian binary encoding of a positive number.</p>
</li><li>
<p><code>10</code> - Decimal number representation, with a leading ‘-’ for a negative number.</p>
</li><li>
<p><code>16</code> - Hexadeciaml number representation, with a leading ‘-’ for a negative number.</p>
</li></ul>
</dd></dl>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_initialize(int argc, VALUE *argv, VALUE self)
{
    BIGNUM *bn;
    VALUE str, bs;
    int base = 10;
    char *ptr;

    if (rb_scan_args(argc, argv, &quot;11&quot;, &amp;str, &amp;bs) == 2) {
        base = NUM2INT(bs);
    }

    if (NIL_P(str)) {
        ossl_raise(rb_eArgError, &quot;invalid argument&quot;);
    }

    if (RB_INTEGER_TYPE_P(str)) {
        GetBN(self, bn);
        integer_to_bnptr(str, bn);

        return self;
    }

    if (RTEST(rb_obj_is_kind_of(str, cBN))) {
        BIGNUM *other;

        GetBN(self, bn);
        GetBN(str, other); /* Safe - we checked kind_of? above */
        if (!BN_copy(bn, other)) {
            ossl_raise(eBNError, NULL);
        }
        return self;
    }

    GetBN(self, bn);
    switch (base) {
    case 0:
        ptr = StringValuePtr(str);
        if (!BN_mpi2bn((unsigned char *)ptr, RSTRING_LENINT(str), bn)) {
            ossl_raise(eBNError, NULL);
        }
        break;
    case 2:
        ptr = StringValuePtr(str);
        if (!BN_bin2bn((unsigned char *)ptr, RSTRING_LENINT(str), bn)) {
            ossl_raise(eBNError, NULL);
        }
        break;
    case 10:
        if (!BN_dec2bn(&amp;bn, StringValueCStr(str))) {
            ossl_raise(eBNError, NULL);
        }
        break;
    case 16:
        if (!BN_hex2bn(&amp;bn, StringValueCStr(str))) {
            ossl_raise(eBNError, NULL);
        }
        break;
    default:
        ossl_raise(rb_eArgError, &quot;invalid radix %d&quot;, base);
    }
    return self;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-c-rand">
            
              <b>BN.rand(bits [, fill [, odd]]) &rarr; aBN
</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-c-rand" name="method-c-rand" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Generates a cryptographically strong pseudo-random number of <code>bits</code>.</p>

<p>See also the man page BN_rand(3).</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-rand_source')" id="l_method-c-rand_source">show</a>
                
              </p>
              <div id="method-c-rand_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_s_rand(int argc, VALUE *argv, VALUE klass)
{
    BIGNUM *result;
    int bottom = 0, top = 0, b;
    VALUE bits, fill, odd, obj;

    switch (rb_scan_args(argc, argv, &quot;12&quot;, &amp;bits, &amp;fill, &amp;odd)) {
      case 3:
        bottom = (odd == Qtrue) ? 1 : 0;
        /* FALLTHROUGH */
      case 2:
        top = NUM2INT(fill);
    }
    b = NUM2INT(bits);
    obj = NewBN(klass);
    if (!(result = BN_new())) {
        ossl_raise(eBNError, &quot;BN_new&quot;);
    }
    if (BN_rand(result, b, top, bottom) &lt;= 0) {
        BN_free(result);
        ossl_raise(eBNError, &quot;BN_rand&quot;);
    }
    SetBN(obj, result);
    return obj;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-c-rand_range">
            
              <b>BN.rand_range(range) &rarr; aBN
</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-c-rand_range" name="method-c-rand_range" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Generates a cryptographically strong pseudo-random number in the range 0…<code>range</code>.</p>

<p>See also the man page BN_rand_range(3).</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-rand_range_source')" id="l_method-c-rand_range_source">show</a>
                
              </p>
              <div id="method-c-rand_range_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_s_rand_range(VALUE klass, VALUE range)
{
    BIGNUM *bn = GetBNPtr(range), *result;
    VALUE obj = NewBN(klass);
    if (!(result = BN_new()))
        ossl_raise(eBNError, &quot;BN_new&quot;);
    if (BN_rand_range(result, bn) &lt;= 0) {
        BN_free(result);
        ossl_raise(eBNError, &quot;BN_rand_range&quot;);
    }
    SetBN(obj, result);
    return obj;
}</pre>
              </div>
            </div>
            
          </div>
        
      
    
      <h2 class="sectiontitle">Instance Public methods</h2>
      
        <div class="method">
          <h3 class="title method-title" id="method-i-25">
            
              <b>bn % bn2 => aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-25" name="method-i-25" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-2A">
            
              <b>bn * bn2 => aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-2A" name="method-i-2A" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-2A-2A">
            
              <b>bn ** bn2 => aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-2A-2A" name="method-i-2A-2A" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-2B">
            
              <b>bn + bn2 => aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-2B" name="method-i-2B" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-2B-40">
            
              <b>+bn &rarr; aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-2B-40" name="method-i-2B-40" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-2B-40_source')" id="l_method-i-2B-40_source">show</a>
                
              </p>
              <div id="method-i-2B-40_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_uplus(VALUE self)
{
    VALUE obj;
    BIGNUM *bn1, *bn2;

    GetBN(self, bn1);
    obj = NewBN(cBN);
    bn2 = BN_dup(bn1);
    if (!bn2)
        ossl_raise(eBNError, &quot;BN_dup&quot;);
    SetBN(obj, bn2);

    return obj;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-2D">
            
              <b>bn - bn2 => aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-2D" name="method-i-2D" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-2D-40">
            
              <b>-bn &rarr; aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-2D-40" name="method-i-2D-40" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-2D-40_source')" id="l_method-i-2D-40_source">show</a>
                
              </p>
              <div id="method-i-2D-40_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_uminus(VALUE self)
{
    VALUE obj;
    BIGNUM *bn1, *bn2;

    GetBN(self, bn1);
    obj = NewBN(cBN);
    bn2 = BN_dup(bn1);
    if (!bn2)
        ossl_raise(eBNError, &quot;BN_dup&quot;);
    SetBN(obj, bn2);
    BN_set_negative(bn2, !BN_is_negative(bn2));

    return obj;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-2F">
            
              <b>bn1 / bn2 => [result, remainder]
</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-2F" name="method-i-2F" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Division of <a href="BN.html"><code>OpenSSL::BN</code></a> instances</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-2F_source')" id="l_method-i-2F_source">show</a>
                
              </p>
              <div id="method-i-2F_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_div(VALUE self, VALUE other)
{
    BIGNUM *bn1, *bn2 = GetBNPtr(other), *r1, *r2;
    VALUE klass, obj1, obj2;

    GetBN(self, bn1);

    klass = rb_obj_class(self);
    obj1 = NewBN(klass);
    obj2 = NewBN(klass);
    if (!(r1 = BN_new())) {
        ossl_raise(eBNError, NULL);
    }
    if (!(r2 = BN_new())) {
        BN_free(r1);
        ossl_raise(eBNError, NULL);
    }
    if (!BN_div(r1, r2, bn1, bn2, ossl_bn_ctx)) {
        BN_free(r1);
        BN_free(r2);
        ossl_raise(eBNError, NULL);
    }
    SetBN(obj1, r1);
    SetBN(obj2, r2);

    return rb_ary_new3(2, obj1, obj2);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-3C-3C">
            
              <b>bn << bits &rarr; aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-3C-3C" name="method-i-3C-3C" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-3C-3D-3E">
            
              <b>&lt;=&gt;</b>(p1)
            
            <a href="../../classes/OpenSSL/BN.html#method-i-3C-3D-3E" name="method-i-3C-3D-3E" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          
            <div class="aka">
              Alias for: <a href="BN.html#method-i-cmp">cmp</a>
            </div>
          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-3D-3D">
            
              <b>bn == obj => true or false</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-3D-3D" name="method-i-3D-3D" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Returns <code>true</code> only if <em>obj</em> has the same value as <em>bn</em>. Contrast this with <a href="BN.html#method-i-eql-3F"><code>OpenSSL::BN#eql?</code></a>, which requires obj to be <a href="BN.html"><code>OpenSSL::BN</code></a>.</p>
            </div>
          

          
            <div class="aka">
              Also aliased as: <a href="BN.html#method-i-3D-3D-3D">===</a>
            </div>
          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-3D-3D_source')" id="l_method-i-3D-3D_source">show</a>
                
              </p>
              <div id="method-i-3D-3D_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_eq(VALUE self, VALUE other)
{
    BIGNUM *bn1, *bn2;

    GetBN(self, bn1);
    other = try_convert_to_bn(other);
    if (NIL_P(other))
        return Qfalse;
    GetBN(other, bn2);

    if (!BN_cmp(bn1, bn2)) {
        return Qtrue;
    }
    return Qfalse;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-3D-3D-3D">
            
              <b>===</b>(p1)
            
            <a href="../../classes/OpenSSL/BN.html#method-i-3D-3D-3D" name="method-i-3D-3D-3D" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Returns <code>true</code> only if <em>obj</em> has the same value as <em>bn</em>. Contrast this with <a href="BN.html#method-i-eql-3F"><code>OpenSSL::BN#eql?</code></a>, which requires obj to be <a href="BN.html"><code>OpenSSL::BN</code></a>.</p>
            </div>
          

          

          
            <div class="aka">
              Alias for: <a href="BN.html#method-i-3D-3D">==</a>
            </div>
          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-3E-3E">
            
              <b>bn >> bits &rarr; aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-3E-3E" name="method-i-3E-3E" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-abs">
            
              <b>bn.abs &rarr; aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-abs" name="method-i-abs" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-abs_source')" id="l_method-i-abs_source">show</a>
                
              </p>
              <div id="method-i-abs_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_abs(VALUE self)
{
    BIGNUM *bn1;

    GetBN(self, bn1);
    if (BN_is_negative(bn1)) {
        return ossl_bn_uminus(self);
    }
    else {
        return ossl_bn_uplus(self);
    }
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-bit_set-3F">
            
              <b>bn.bit_set?(bit) => true | false
</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-bit_set-3F" name="method-i-bit_set-3F" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Tests bit <em>bit</em> in <em>bn</em> and returns <code>true</code> if set, <code>false</code> if not set.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-bit_set-3F_source')" id="l_method-i-bit_set-3F_source">show</a>
                
              </p>
              <div id="method-i-bit_set-3F_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_is_bit_set(VALUE self, VALUE bit)
{
    int b;
    BIGNUM *bn;

    b = NUM2INT(bit);
    GetBN(self, bn);
    if (BN_is_bit_set(bn, b)) {
        return Qtrue;
    }
    return Qfalse;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-clear_bit-21">
            
              <b>bn.clear_bit!(bit) &rarr; self</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-clear_bit-21" name="method-i-clear_bit-21" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-cmp">
            
              <b>bn.cmp(bn2) => integer</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-cmp" name="method-i-cmp" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          
            <div class="aka">
              Also aliased as: <a href="BN.html#method-i-3C-3D-3E">&lt;=&gt;</a>
            </div>
          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-coerce">
            
              <b>coerce</b>(p1)
            
            <a href="../../classes/OpenSSL/BN.html#method-i-coerce" name="method-i-coerce" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-coerce_source')" id="l_method-i-coerce_source">show</a>
                
              </p>
              <div id="method-i-coerce_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_coerce(VALUE self, VALUE other)
{
    switch(TYPE(other)) {
    case T_STRING:
        self = ossl_bn_to_s(0, NULL, self);
        break;
    case T_FIXNUM:
    case T_BIGNUM:
        self = ossl_bn_to_i(self);
        break;
    default:
        if (!RTEST(rb_obj_is_kind_of(other, cBN))) {
            ossl_raise(rb_eTypeError, &quot;Don&#39;t know how to coerce&quot;);
        }
    }
    return rb_assoc_new(other, self);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-copy">
            
              <b>copy</b>(p1)
            
            <a href="../../classes/OpenSSL/BN.html#method-i-copy" name="method-i-copy" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          
            <div class="aka">
              Alias for: <a href="BN.html#method-i-initialize_copy">initialize_copy</a>
            </div>
          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-eql-3F">
            
              <b>bn.eql?(obj) => true or false
</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-eql-3F" name="method-i-eql-3F" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Returns <code>true</code> only if <em>obj</em> is a <code>OpenSSL::BN</code> with the same value as <em>bn</em>. Contrast this with <a href="BN.html#method-i-3D-3D"><code>OpenSSL::BN#==</code></a>, which performs type conversions.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-eql-3F_source')" id="l_method-i-eql-3F_source">show</a>
                
              </p>
              <div id="method-i-eql-3F_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_eql(VALUE self, VALUE other)
{
    BIGNUM *bn1, *bn2;

    if (!rb_obj_is_kind_of(other, cBN))
        return Qfalse;
    GetBN(self, bn1);
    GetBN(other, bn2);

    return BN_cmp(bn1, bn2) ? Qfalse : Qtrue;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-gcd">
            
              <b>bn.gcd(bn2) => aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-gcd" name="method-i-gcd" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-get_flags">
            
              <b>bn.get_flags(flags) => flags
</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-get_flags" name="method-i-get_flags" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Returns the flags on the <a href="BN.html"><code>BN</code></a> object. The argument is used as a bit mask.</p>

<h3 id="method-i-get_flags-label-Parameters">Parameters</h3>
<ul><li>
<p><em>flags</em> - integer</p>
</li></ul>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-get_flags_source')" id="l_method-i-get_flags_source">show</a>
                
              </p>
              <div id="method-i-get_flags_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_get_flags(VALUE self, VALUE arg)
{
    BIGNUM *bn;
    GetBN(self, bn);

    return INT2NUM(BN_get_flags(bn, NUM2INT(arg)));
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-hash">
            
              <b>bn.hash => Integer
</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-hash" name="method-i-hash" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Returns a hash code for this object.</p>

<p>See also <a href="../Object.html#method-i-hash"><code>Object#hash</code></a>.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-hash_source')" id="l_method-i-hash_source">show</a>
                
              </p>
              <div id="method-i-hash_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_hash(VALUE self)
{
    BIGNUM *bn;
    VALUE tmp, hash;
    unsigned char *buf;
    int len;

    GetBN(self, bn);
    len = BN_num_bytes(bn);
    buf = ALLOCV(tmp, len);
    if (BN_bn2bin(bn, buf) != len) {
        ALLOCV_END(tmp);
        ossl_raise(eBNError, &quot;BN_bn2bin&quot;);
    }

    hash = ST2FIX(rb_memhash(buf, len));
    ALLOCV_END(tmp);

    return hash;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-initialize_copy">
            
              <b>initialize_copy</b>(p1)
            
            <a href="../../classes/OpenSSL/BN.html#method-i-initialize_copy" name="method-i-initialize_copy" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          
            <div class="aka">
              Also aliased as: <a href="BN.html#method-i-copy">copy</a>
            </div>
          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-initialize_copy_source')" id="l_method-i-initialize_copy_source">show</a>
                
              </p>
              <div id="method-i-initialize_copy_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_copy(VALUE self, VALUE other)
{
    BIGNUM *bn1, *bn2;

    rb_check_frozen(self);

    if (self == other) return self;

    GetBN(self, bn1);
    bn2 = GetBNPtr(other);

    if (!BN_copy(bn1, bn2)) {
        ossl_raise(eBNError, NULL);
    }
    return self;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-lshift-21">
            
              <b>bn.lshift!(bits) &rarr; self</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-lshift-21" name="method-i-lshift-21" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-mod_add">
            
              <b>bn.mod_add(bn1, bn2) &rarr; aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-mod_add" name="method-i-mod_add" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-mod_exp">
            
              <b>bn.mod_exp(bn1, bn2) &rarr; aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-mod_exp" name="method-i-mod_exp" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-mod_inverse">
            
              <b>bn.mod_inverse(bn2) => aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-mod_inverse" name="method-i-mod_inverse" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-mod_mul">
            
              <b>bn.mod_mul(bn1, bn2) &rarr; aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-mod_mul" name="method-i-mod_mul" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-mod_sqr">
            
              <b>bn.mod_sqr(bn2) => aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-mod_sqr" name="method-i-mod_sqr" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-mod_sqrt">
            
              <b>bn.mod_sqrt(bn2) => aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-mod_sqrt" name="method-i-mod_sqrt" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-mod_sub">
            
              <b>bn.mod_sub(bn1, bn2) &rarr; aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-mod_sub" name="method-i-mod_sub" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-negative-3F">
            
              <b>bn.negative? => true | false</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-negative-3F" name="method-i-negative-3F" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-negative-3F_source')" id="l_method-i-negative-3F_source">show</a>
                
              </p>
              <div id="method-i-negative-3F_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_is_negative(VALUE self)
{
    BIGNUM *bn;

    GetBN(self, bn);
    if (BN_is_zero(bn))
        return Qfalse;
    return BN_is_negative(bn) ? Qtrue : Qfalse;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-num_bits">
            
              <b>bn.num_bits => integer</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-num_bits" name="method-i-num_bits" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-num_bytes">
            
              <b>bn.num_bytes => integer</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-num_bytes" name="method-i-num_bytes" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-odd-3F">
            
              <b>bn.odd? => true | false</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-odd-3F" name="method-i-odd-3F" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-one-3F">
            
              <b>bn.one? => true | false</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-one-3F" name="method-i-one-3F" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-pretty_print">
            
              <b>pretty_print</b>(q)
            
            <a href="../../classes/OpenSSL/BN.html#method-i-pretty_print" name="method-i-pretty_print" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-pretty_print_source')" id="l_method-i-pretty_print_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7b55c452b7d9a295d148ff882e0197cd139a9f8f/ext/openssl/lib/openssl/bn.rb#L20" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-pretty_print_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/ext/openssl/lib/openssl/bn.rb, line 20</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pretty_print</span>(<span class="ruby-identifier">q</span>)
  <span class="ruby-identifier">q</span>.<span class="ruby-identifier">object_group</span>(<span class="ruby-keyword">self</span>) {
    <span class="ruby-identifier">q</span>.<span class="ruby-identifier">text</span> <span class="ruby-string">&#39; &#39;</span>
    <span class="ruby-identifier">q</span>.<span class="ruby-identifier">text</span> <span class="ruby-identifier">to_i</span>.<span class="ruby-identifier">to_s</span>
  }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-prime-3F">
            
              <b>bn.prime? => true | false<br />bn.prime?(checks) => true | false
</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-prime-3F" name="method-i-prime-3F" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Performs a Miller-Rabin probabilistic primality test for <code>bn</code>.</p>

<p><strong><code>checks</code> parameter is deprecated in version 3.0.</strong> It has no effect.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-prime-3F_source')" id="l_method-i-prime-3F_source">show</a>
                
              </p>
              <div id="method-i-prime-3F_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_is_prime(int argc, VALUE *argv, VALUE self)
{
    BIGNUM *bn;
    int ret;

    rb_check_arity(argc, 0, 1);
    GetBN(self, bn);

#ifdef HAVE_BN_CHECK_PRIME
    ret = BN_check_prime(bn, ossl_bn_ctx, NULL);
    if (ret &lt; 0)
        ossl_raise(eBNError, &quot;BN_check_prime&quot;);
#else
    ret = BN_is_prime_fasttest_ex(bn, BN_prime_checks, ossl_bn_ctx, 1, NULL);
    if (ret &lt; 0)
        ossl_raise(eBNError, &quot;BN_is_prime_fasttest_ex&quot;);
#endif
    return ret ? Qtrue : Qfalse;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-prime_fasttest-3F">
            
              <b>bn.prime_fasttest? => true | false<br />bn.prime_fasttest?(checks) => true | false<br />bn.prime_fasttest?(checks, trial_div) => true | false
</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-prime_fasttest-3F" name="method-i-prime_fasttest-3F" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Performs a Miller-Rabin probabilistic primality test for <code>bn</code>.</p>

<p><strong>Deprecated in version 3.0.</strong> Use <a href="BN.html#method-i-prime-3F"><code>prime?</code></a> instead.</p>

<p><code>checks</code> and <code>trial_div</code> parameters no longer have any effect.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-prime_fasttest-3F_source')" id="l_method-i-prime_fasttest-3F_source">show</a>
                
              </p>
              <div id="method-i-prime_fasttest-3F_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_is_prime_fasttest(int argc, VALUE *argv, VALUE self)
{
    rb_check_arity(argc, 0, 2);
    return ossl_bn_is_prime(0, argv, self);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-rshift-21">
            
              <b>bn.rshift!(bits) &rarr; self</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-rshift-21" name="method-i-rshift-21" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-set_bit-21">
            
              <b>bn.set_bit!(bit) &rarr; self</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-set_bit-21" name="method-i-set_bit-21" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-set_flags">
            
              <b>bn.set_flags(flags) => nil
</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-set_flags" name="method-i-set_flags" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Enables the flags on the <a href="BN.html"><code>BN</code></a> object. Currently, the flags argument can contain zero of <a href="BN.html#CONSTTIME"><code>OpenSSL::BN::CONSTTIME</code></a>.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-set_flags_source')" id="l_method-i-set_flags_source">show</a>
                
              </p>
              <div id="method-i-set_flags_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_set_flags(VALUE self, VALUE arg)
{
    BIGNUM *bn;
    GetBN(self, bn);

    BN_set_flags(bn, NUM2INT(arg));
    return Qnil;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-sqr">
            
              <b>bn.sqr => aBN</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-sqr" name="method-i-sqr" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-to_bn">
            
              <b>to_bn</b>()
            
            <a href="../../classes/OpenSSL/BN.html#method-i-to_bn" name="method-i-to_bn" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-to_bn_source')" id="l_method-i-to_bn_source">show</a>
                
              </p>
              <div id="method-i-to_bn_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_to_bn(VALUE self)
{
    return self;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-to_i">
            
              <b>bn.to_i => integer</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-to_i" name="method-i-to_i" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          
            <div class="aka">
              Also aliased as: <a href="BN.html#method-i-to_int">to_int</a>
            </div>
          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-to_i_source')" id="l_method-i-to_i_source">show</a>
                
              </p>
              <div id="method-i-to_i_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_to_i(VALUE self)
{
    BIGNUM *bn;
    char *txt;
    VALUE num;

    GetBN(self, bn);

    if (!(txt = BN_bn2hex(bn))) {
        ossl_raise(eBNError, NULL);
    }
    num = rb_cstr_to_inum(txt, 16, Qtrue);
    OPENSSL_free(txt);

    return num;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-to_int">
            
              <b>to_int</b>()
            
            <a href="../../classes/OpenSSL/BN.html#method-i-to_int" name="method-i-to_int" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          
            <div class="aka">
              Alias for: <a href="BN.html#method-i-to_i">to_i</a>
            </div>
          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-to_s">
            
              <b>bn.to_s(base = 10) &rarr; string
</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-to_s" name="method-i-to_s" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Returns the string representation of the bignum.</p>

<p><a href="BN.html#method-c-new"><code>BN.new</code></a> can parse the encoded string to convert back into an <a href="BN.html"><code>OpenSSL::BN</code></a>.</p>
<dl class="rdoc-list note-list"><dt><code>base</code>
<dd>
<p>The format. Must be one of the following:</p>
<ul><li>
<p><code>0</code>  - MPI format. See the man page BN_bn2mpi(3) for details.</p>
</li><li>
<p><code>2</code>  - Variable-length and big-endian binary encoding. The sign of the bignum is ignored.</p>
</li><li>
<p><code>10</code> - Decimal number representation, with a leading ‘-’ for a negative bignum.</p>
</li><li>
<p><code>16</code> - Hexadeciaml number representation, with a leading ‘-’ for a negative bignum.</p>
</li></ul>
</dd></dl>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-to_s_source')" id="l_method-i-to_s_source">show</a>
                
              </p>
              <div id="method-i-to_s_source" class="dyn-source">
                <pre>static VALUE
ossl_bn_to_s(int argc, VALUE *argv, VALUE self)
{
    BIGNUM *bn;
    VALUE str, bs;
    int base = 10, len;
    char *buf;

    if (rb_scan_args(argc, argv, &quot;01&quot;, &amp;bs) == 1) {
        base = NUM2INT(bs);
    }
    GetBN(self, bn);
    switch (base) {
    case 0:
        len = BN_bn2mpi(bn, NULL);
        str = rb_str_new(0, len);
        if (BN_bn2mpi(bn, (unsigned char *)RSTRING_PTR(str)) != len)
            ossl_raise(eBNError, NULL);
        break;
    case 2:
        len = BN_num_bytes(bn);
        str = rb_str_new(0, len);
        if (BN_bn2bin(bn, (unsigned char *)RSTRING_PTR(str)) != len)
            ossl_raise(eBNError, NULL);
        break;
    case 10:
        if (!(buf = BN_bn2dec(bn))) ossl_raise(eBNError, NULL);
        str = ossl_buf2str(buf, rb_long2int(strlen(buf)));
        break;
    case 16:
        if (!(buf = BN_bn2hex(bn))) ossl_raise(eBNError, NULL);
        str = ossl_buf2str(buf, rb_long2int(strlen(buf)));
        break;
    default:
        ossl_raise(rb_eArgError, &quot;invalid radix %d&quot;, base);
    }

    return str;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-ucmp">
            
              <b>bn.ucmp(bn2) => integer</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-ucmp" name="method-i-ucmp" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-zero-3F">
            
              <b>bn.zero? => true | false</b>
            
            <a href="../../classes/OpenSSL/BN.html#method-i-zero-3F" name="method-i-zero-3F" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          </div>
        
      
    
  
</div>

    </main>
  </body>
</html>
