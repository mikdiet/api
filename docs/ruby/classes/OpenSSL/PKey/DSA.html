<!DOCTYPE html>
<html lang="en">
<head>
    <title>OpenSSL::PKey::DSA</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
<link rel="stylesheet" href="/css/reset.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/panel.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/main.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/github.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<script src="/js/jquery-3.5.1.min.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/main.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/highlight.pack.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/turbolinks.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/search_index.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/searcher.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/panel/tree.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/searchdoc.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>

<meta name="data-rel-prefix" content="/">
<meta name="data-tree-keys" content='["OpenSSL", "PKey", "DSA"]'>


    <meta property="og:title" value="OpenSSL::PKey::DSA">

  
    
    <meta name="description" content="DSA, the Digital Signature Algorithm, is specified in NIST’s FIPS 186-3. It is an asymmetric public key algorithm that may be used similar to e.g. RSA.">
    <meta property="og:description" content="DSA, the Digital Signature Algorithm, is specified in NIST’s FIPS 186-3. It is an asymmetric public key algorithm that may be used similar to e.g. RSA.">
  

    <meta name="keywords" content="OpenSSL::PKey::DSA class, public_key, generate, syssign, sysverify, new, initialize_copy, public?, private?, export, to_der, set_pqg, set_key, params, to_pem, to_s">
</head>

<body>
    <a class="sr-only sr-only-focusable" href="#content" data-turbolinks="false">Skip to Content</a>
    <a class="sr-only sr-only-focusable" href="#search" data-turbolinks="false">Skip to Search</a>

    <input type="checkbox" id="hamburger" class="panel_checkbox">
<label class="panel_mobile_button" for="hamburger"><span></span> Menu</label>
<nav class="panel panel_tree" id="panel" data-turbolinks-permanent>
  <div class="header">
    <input type="text" placeholder="Search (/) for a class, method, ..." autosave="searchdoc" results="10" id="search" autocomplete="off" tabindex="-1" />
    <label class="panel_mobile_button_close" for="hamburger"><span></span> Close</label>
  </div>
  <div class="tree">
    <ul>
    </ul>
  </div>
  <div class="result">
    <ul>
    </ul>
  </div>
  <a href="links.html" id="links">index</a>
</nav>


    <div class="banner">
        
        <h2>
            <span class="type">Class</span>
            OpenSSL::PKey::DSA
            
                <span class="parent">&lt;
                    
                    <a href="PKey.html">OpenSSL::PKey::PKey</a>
                    
                </span>
            
        </h2>
        <ul class="files">
            
            <li><a href="../../../files/ruby/ext/openssl/lib/openssl/pkey_rb.html">ruby/ext/openssl/lib/openssl/pkey.rb</a></li>
            
            <li><a href="../../../files/ruby/ext/openssl/ossl_pkey_c.html">ruby/ext/openssl/ossl_pkey.c</a></li>
            
        </ul>
    </div>

    <main id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p><a href="DSA.html"><code>DSA</code></a>, the Digital Signature Algorithm, is specified in NIST’s FIPS 186-3. It is an asymmetric public key algorithm that may be used similar to e.g. <a href="RSA.html"><code>RSA</code></a>.</p>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>E</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-export">export</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>G</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-generate">generate</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-initialize_copy">initialize_copy</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>P</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-params">params</a>,
              </li>
            
              
              <li>
                <a href="#method-i-private-3F">private?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-public-3F">public?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-public_key">public_key</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-set_key">set_key</a>,
              </li>
            
              
              <li>
                <a href="#method-i-set_pqg">set_pqg</a>,
              </li>
            
              
              <li>
                <a href="#method-i-syssign">syssign</a>,
              </li>
            
              
              <li>
                <a href="#method-i-sysverify">sysverify</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-to_der">to_der</a>,
              </li>
            
              
              <li>
                <a href="#method-i-to_pem">to_pem</a>,
              </li>
            
              
              <li>
                <a href="#method-i-to_s">to_s</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  
    <!-- Includes -->
    <div class="sectiontitle">Included Modules</div>
    <ul>
      
        <li>
          
            <a href="../Marshal.html">
              OpenSSL::Marshal
            </a>
          
        </li>
      
    </ul>
  



  

    

    

    


    


    <!-- Methods -->
    
      <h2 class="sectiontitle">Class Public methods</h2>
      
        <div class="method">
          <h3 class="title method-title" id="method-c-generate">
            
              <b>DSA.generate(size) &rarr; dsa
</b>
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-c-generate" name="method-c-generate" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Creates a new <a href="DSA.html"><code>DSA</code></a> instance by generating a private/public key pair from scratch.</p>

<p>See also <a href="../PKey.html#method-c-generate_parameters"><code>OpenSSL::PKey.generate_parameters</code></a> and <a href="../PKey.html#method-c-generate_key"><code>OpenSSL::PKey.generate_key</code></a>.</p>
<dl class="rdoc-list note-list"><dt><code>size</code>
<dd>
<p>The desired key size in bits.</p>
</dd></dl>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-generate_source')" id="l_method-c-generate_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7b55c452b7d9a295d148ff882e0197cd139a9f8f/ext/openssl/lib/openssl/pkey.rb#L169" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-c-generate_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/ext/openssl/lib/openssl/pkey.rb, line 169</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate</span>(<span class="ruby-identifier">size</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
  <span class="ruby-comment"># FIPS 186-4 specifies four (L,N) pairs: (1024,160), (2048,224),</span>
  <span class="ruby-comment"># (2048,256), and (3072,256).</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-comment"># q size is derived here with compatibility with</span>
  <span class="ruby-comment"># DSA_generator_parameters_ex() which previous versions of ruby/openssl</span>
  <span class="ruby-comment"># used to call.</span>
  <span class="ruby-identifier">qsize</span> = <span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">2048</span> <span class="ruby-operator">?</span> <span class="ruby-value">256</span> <span class="ruby-operator">:</span> <span class="ruby-value">160</span>
  <span class="ruby-identifier">dsaparams</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span>.<span class="ruby-identifier">generate_parameters</span>(<span class="ruby-string">&quot;DSA&quot;</span>, {
    <span class="ruby-string">&quot;dsa_paramgen_bits&quot;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">size</span>,
    <span class="ruby-string">&quot;dsa_paramgen_q_bits&quot;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">qsize</span>,
  }, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
  <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span>.<span class="ruby-identifier">generate_key</span>(<span class="ruby-identifier">dsaparams</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-c-new">
            
              <b>DSA.new &rarr; dsa<br />DSA.new(string [, pass]) &rarr; dsa<br />DSA.new(size) &rarr; dsa
</b>
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-c-new" name="method-c-new" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Creates a new <a href="DSA.html"><code>DSA</code></a> instance by reading an existing key from <em>string</em>.</p>

<p>If called without arguments, creates a new instance with no key components set. They can be set individually by <a href="DSA.html#method-i-set_pqg"><code>set_pqg</code></a> and <a href="DSA.html#method-i-set_key"><code>set_key</code></a>.</p>

<p>If called with a <a href="../../String.html"><code>String</code></a>, tries to parse as DER or PEM encoding of a DSA key. See also <a href="../PKey.html#method-c-read"><code>OpenSSL::PKey.read</code></a> which can parse keys of any kinds.</p>

<p>If called with a number, generates random parameters and a key pair. This form works as an alias of <a href="DSA.html#method-c-generate"><code>DSA.generate</code></a>.</p>
<dl class="rdoc-list note-list"><dt><code>string</code>
<dd>
<p>A <a href="../../String.html"><code>String</code></a> that contains a DER or PEM encoded key.</p>
</dd><dt><code>pass</code>
<dd>
<p>A <a href="../../String.html"><code>String</code></a> that contains an optional password.</p>
</dd><dt><code>size</code>
<dd>
<p>See <a href="DSA.html#method-c-generate"><code>DSA.generate</code></a>.</p>
</dd></dl>

<p>Examples:</p>

<pre><code>p OpenSSL::PKey::DSA.new(1024)
#=&gt; #&lt;OpenSSL::PKey::DSA:0x000055a8d6025bf0 oid=DSA&gt;

p OpenSSL::PKey::DSA.new(File.read(&#39;dsa.pem&#39;))
#=&gt; #&lt;OpenSSL::PKey::DSA:0x000055555d6b8110 oid=DSA&gt;

p OpenSSL::PKey::DSA.new(File.read(&#39;dsa.pem&#39;), &#39;mypassword&#39;)
#=&gt; #&lt;OpenSSL::PKey::DSA:0x0000556f973c40b8 oid=DSA&gt;
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre>static VALUE
ossl_dsa_initialize(int argc, VALUE *argv, VALUE self)
{
    EVP_PKEY *pkey;
    DSA *dsa;
    BIO *in = NULL;
    VALUE arg, pass;
    int type;

    TypedData_Get_Struct(self, EVP_PKEY, &amp;ossl_evp_pkey_type, pkey);
    if (pkey)
        rb_raise(rb_eTypeError, &quot;pkey already initialized&quot;);

    /* The DSA.new(size, generator) form is handled by lib/openssl/pkey.rb */
    rb_scan_args(argc, argv, &quot;02&quot;, &amp;arg, &amp;pass);
    if (argc == 0) {
        dsa = DSA_new();
        if (!dsa)
            ossl_raise(eDSAError, &quot;DSA_new&quot;);
        goto legacy;
    }

    pass = ossl_pem_passwd_value(pass);
    arg = ossl_to_der_if_possible(arg);
    in = ossl_obj2bio(&amp;arg);

    /* DER-encoded DSAPublicKey format isn&#39;t supported by the generic routine */
    dsa = (DSA *)PEM_ASN1_read_bio((d2i_of_void *)d2i_DSAPublicKey,
                                   PEM_STRING_DSA_PUBLIC,
                                   in, NULL, NULL, NULL);
    if (dsa)
        goto legacy;
    OSSL_BIO_reset(in);

    pkey = ossl_pkey_read_generic(in, pass);
    BIO_free(in);
    if (!pkey)
        ossl_raise(eDSAError, &quot;Neither PUB key nor PRIV key&quot;);

    type = EVP_PKEY_base_id(pkey);
    if (type != EVP_PKEY_DSA) {
        EVP_PKEY_free(pkey);
        rb_raise(eDSAError, &quot;incorrect pkey type: %s&quot;, OBJ_nid2sn(type));
    }
    RTYPEDDATA_DATA(self) = pkey;
    return self;

  legacy:
    BIO_free(in);
    pkey = EVP_PKEY_new();
    if (!pkey || EVP_PKEY_assign_DSA(pkey, dsa) != 1) {
        EVP_PKEY_free(pkey);
        DSA_free(dsa);
        ossl_raise(eDSAError, &quot;EVP_PKEY_assign_DSA&quot;);
    }
    RTYPEDDATA_DATA(self) = pkey;
    return self;
}</pre>
              </div>
            </div>
            
          </div>
        
      
    
      <h2 class="sectiontitle">Instance Public methods</h2>
      
        <div class="method">
          <h3 class="title method-title" id="method-i-export">
            
              <b>dsa.export([cipher, password]) &rarr; aString</b>
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-i-export" name="method-i-export" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Serializes a private or public key to a PEM-encoding.</p>
<dl class="rdoc-list label-list"><dt>When the key contains public components only
<dd>
<p>Serializes it into an X.509 SubjectPublicKeyInfo. The parameters <em>cipher</em> and <em>password</em> are ignored.</p>

<p>A PEM-encoded key will look like:</p>

<pre><code>-----BEGIN PUBLIC KEY-----
[...]
-----END PUBLIC KEY-----
</code></pre>

<p>Consider using <a href="PKey.html#method-i-public_to_pem"><code>public_to_pem</code></a> instead. This serializes the key into an X.509 SubjectPublicKeyInfo regardless of whether it is a public key or a private key.</p>
</dd><dt>When the key contains private components, and no parameters are given
<dd>
<p>Serializes it into a traditional OpenSSL DSAPrivateKey.</p>

<p>A PEM-encoded key will look like:</p>

<pre><code>-----BEGIN DSA PRIVATE KEY-----
[...]
-----END DSA PRIVATE KEY-----
</code></pre>
</dd><dt>When the key contains private components, and <em>cipher</em> and <em>password</em> are given
<dd>
<p>Serializes it into a traditional OpenSSL DSAPrivateKey and encrypts it in OpenSSL’s traditional PEM encryption format. <em>cipher</em> must be a cipher name understood by <a href="../Cipher.html#method-c-new"><code>OpenSSL::Cipher.new</code></a> or an instance of <a href="../Cipher.html"><code>OpenSSL::Cipher</code></a>.</p>

<p>An encrypted PEM-encoded key will look like:</p>

<pre><code>-----BEGIN DSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,733F5302505B34701FC41F5C0746E4C0

[...]
-----END DSA PRIVATE KEY-----
</code></pre>

<p>Note that this format uses MD5 to derive the encryption key, and hence will not be available on FIPS-compliant systems.</p>
</dd></dl>

<p><strong>This method is kept for compatibility.</strong> This should only be used when the traditional, non-standard OpenSSL format is required.</p>

<p>Consider using <a href="PKey.html#method-i-public_to_pem"><code>public_to_pem</code></a> (X.509 SubjectPublicKeyInfo) or <a href="PKey.html#method-i-private_to_pem"><code>private_to_pem</code></a> (PKCS #8 PrivateKeyInfo or EncryptedPrivateKeyInfo) instead.</p>
            </div>
          

          
            <div class="aka">
              Also aliased as: <a href="DSA.html#method-i-to_pem">to_pem</a>, <a href="DSA.html#method-i-to_s">to_s</a>
            </div>
          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-export_source')" id="l_method-i-export_source">show</a>
                
              </p>
              <div id="method-i-export_source" class="dyn-source">
                <pre>static VALUE
ossl_dsa_export(int argc, VALUE *argv, VALUE self)
{
    OSSL_3_const DSA *dsa;

    GetDSA(self, dsa);
    if (DSA_HAS_PRIVATE(dsa))
        return ossl_pkey_export_traditional(argc, argv, self, 0);
    else
        return ossl_pkey_export_spki(self, 0);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-initialize_copy">
            
              <b>initialize_copy</b>(p1)
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-i-initialize_copy" name="method-i-initialize_copy" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-initialize_copy_source')" id="l_method-i-initialize_copy_source">show</a>
                
              </p>
              <div id="method-i-initialize_copy_source" class="dyn-source">
                <pre>static VALUE
ossl_dsa_initialize_copy(VALUE self, VALUE other)
{
    EVP_PKEY *pkey;
    DSA *dsa, *dsa_new;

    TypedData_Get_Struct(self, EVP_PKEY, &amp;ossl_evp_pkey_type, pkey);
    if (pkey)
        rb_raise(rb_eTypeError, &quot;pkey already initialized&quot;);
    GetDSA(other, dsa);

    dsa_new = (DSA *)ASN1_dup((i2d_of_void *)i2d_DSAPrivateKey,
                              (d2i_of_void *)d2i_DSAPrivateKey,
                              (char *)dsa);
    if (!dsa_new)
        ossl_raise(eDSAError, &quot;ASN1_dup&quot;);

    pkey = EVP_PKEY_new();
    if (!pkey || EVP_PKEY_assign_DSA(pkey, dsa_new) != 1) {
        EVP_PKEY_free(pkey);
        DSA_free(dsa_new);
        ossl_raise(eDSAError, &quot;EVP_PKEY_assign_DSA&quot;);
    }
    RTYPEDDATA_DATA(self) = pkey;

    return self;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-params">
            
              <b>dsa.params &rarr; hash
</b>
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-i-params" name="method-i-params" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Stores all parameters of key to the hash INSECURE: PRIVATE INFORMATIONS CAN LEAK OUT!!! Don’t use :-)) (I’s up to you)</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-params_source')" id="l_method-i-params_source">show</a>
                
              </p>
              <div id="method-i-params_source" class="dyn-source">
                <pre>static VALUE
ossl_dsa_get_params(VALUE self)
{
    OSSL_3_const DSA *dsa;
    VALUE hash;
    const BIGNUM *p, *q, *g, *pub_key, *priv_key;

    GetDSA(self, dsa);
    DSA_get0_pqg(dsa, &amp;p, &amp;q, &amp;g);
    DSA_get0_key(dsa, &amp;pub_key, &amp;priv_key);

    hash = rb_hash_new();
    rb_hash_aset(hash, rb_str_new2(&quot;p&quot;), ossl_bn_new(p));
    rb_hash_aset(hash, rb_str_new2(&quot;q&quot;), ossl_bn_new(q));
    rb_hash_aset(hash, rb_str_new2(&quot;g&quot;), ossl_bn_new(g));
    rb_hash_aset(hash, rb_str_new2(&quot;pub_key&quot;), ossl_bn_new(pub_key));
    rb_hash_aset(hash, rb_str_new2(&quot;priv_key&quot;), ossl_bn_new(priv_key));

    return hash;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-private-3F">
            
              <b>dsa.private? &rarr; true | false
</b>
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-i-private-3F" name="method-i-private-3F" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Indicates whether this <a href="DSA.html"><code>DSA</code></a> instance has a private key associated with it or not. The private key may be retrieved with DSA#private_key.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-private-3F_source')" id="l_method-i-private-3F_source">show</a>
                
              </p>
              <div id="method-i-private-3F_source" class="dyn-source">
                <pre>static VALUE
ossl_dsa_is_private(VALUE self)
{
    OSSL_3_const DSA *dsa;

    GetDSA(self, dsa);

    return DSA_PRIVATE(self, dsa) ? Qtrue : Qfalse;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-public-3F">
            
              <b>dsa.public? &rarr; true | false
</b>
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-i-public-3F" name="method-i-public-3F" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Indicates whether this <a href="DSA.html"><code>DSA</code></a> instance has a public key associated with it or not. The public key may be retrieved with <a href="DSA.html#method-i-public_key"><code>DSA#public_key</code></a>.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-public-3F_source')" id="l_method-i-public-3F_source">show</a>
                
              </p>
              <div id="method-i-public-3F_source" class="dyn-source">
                <pre>static VALUE
ossl_dsa_is_public(VALUE self)
{
    const DSA *dsa;
    const BIGNUM *bn;

    GetDSA(self, dsa);
    DSA_get0_key(dsa, &amp;bn, NULL);

    return bn ? Qtrue : Qfalse;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-public_key">
            
              <b>dsa.public_key &rarr; dsanew
</b>
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-i-public_key" name="method-i-public_key" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Returns a new <a href="DSA.html"><code>DSA</code></a> instance that carries just the DSA parameters and the public key.</p>

<p>This method is provided for backwards compatibility. In most cases, there is no need to call this method.</p>

<p>For the purpose of serializing the public key, to PEM or DER encoding of X.509 SubjectPublicKeyInfo format, check <a href="PKey.html#method-i-public_to_pem"><code>PKey#public_to_pem</code></a> and <a href="PKey.html#method-i-public_to_der"><code>PKey#public_to_der</code></a>.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-public_key_source')" id="l_method-i-public_key_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7b55c452b7d9a295d148ff882e0197cd139a9f8f/ext/openssl/lib/openssl/pkey.rb#L153" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-public_key_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/ext/openssl/lib/openssl/pkey.rb, line 153</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">public_key</span>
  <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">public_to_der</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-set_key">
            
              <b>dsa.set_key(pub_key, priv_key) &rarr; self
</b>
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-i-set_key" name="method-i-set_key" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Sets <em>pub_key</em> and <em>priv_key</em> for the <a href="DSA.html"><code>DSA</code></a> instance. <em>priv_key</em> may be <code>nil</code>.</p>
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-set_pqg">
            
              <b>dsa.set_pqg(p, q, g) &rarr; self
</b>
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-i-set_pqg" name="method-i-set_pqg" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Sets <em>p</em>, <em>q</em>, <em>g</em> to the <a href="DSA.html"><code>DSA</code></a> instance.</p>
            </div>
          

          

          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-syssign">
            
              <b>dsa.syssign(string) &rarr; string
</b>
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-i-syssign" name="method-i-syssign" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Computes and returns the DSA signature of <code>string</code>, where <code>string</code> is expected to be an already-computed message digest of the original input data. The signature is issued using the private key of this <a href="DSA.html"><code>DSA</code></a> instance.</p>

<p><strong>Deprecated in version 3.0</strong>. Consider using <a href="PKey.html#method-i-sign_raw"><code>PKey::PKey#sign_raw</code></a> and <a href="PKey.html#method-i-verify_raw"><code>PKey::PKey#verify_raw</code></a> instead.</p>
<dl class="rdoc-list note-list"><dt><code>string</code>
<dd>
<p>A message digest of the original input data to be signed.</p>
</dd></dl>

<p>Example:</p>

<pre><code>dsa = OpenSSL::PKey::DSA.new(2048)
doc = &quot;Sign me&quot;
digest = OpenSSL::Digest.digest(&#39;SHA1&#39;, doc)

# With legacy #syssign and #sysverify:
sig = dsa.syssign(digest)
p dsa.sysverify(digest, sig) #=&gt; true

# With #sign_raw and #verify_raw:
sig = dsa.sign_raw(nil, digest)
p dsa.verify_raw(nil, sig, digest) #=&gt; true
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-syssign_source')" id="l_method-i-syssign_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7b55c452b7d9a295d148ff882e0197cd139a9f8f/ext/openssl/lib/openssl/pkey.rb#L220" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-syssign_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/ext/openssl/lib/openssl/pkey.rb, line 220</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">syssign</span>(<span class="ruby-identifier">string</span>)
  <span class="ruby-identifier">q</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">DSAError</span>, <span class="ruby-string">&quot;incomplete DSA&quot;</span>
  <span class="ruby-identifier">private?</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">DSAError</span>, <span class="ruby-string">&quot;Private DSA key needed!&quot;</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">sign_raw</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">string</span>)
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">PKeyError</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">DSAError</span>, <span class="ruby-identifier">$!</span>.<span class="ruby-identifier">message</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-sysverify">
            
              <b>dsa.sysverify(digest, sig) &rarr; true | false
</b>
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-i-sysverify" name="method-i-sysverify" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Verifies whether the signature is valid given the message digest input. It does so by validating <code>sig</code> using the public key of this <a href="DSA.html"><code>DSA</code></a> instance.</p>

<p><strong>Deprecated in version 3.0</strong>. Consider using <a href="PKey.html#method-i-sign_raw"><code>PKey::PKey#sign_raw</code></a> and <a href="PKey.html#method-i-verify_raw"><code>PKey::PKey#verify_raw</code></a> instead.</p>
<dl class="rdoc-list note-list"><dt><code>digest</code>
<dd>
<p>A message digest of the original input data to be signed.</p>
</dd><dt><code>sig</code>
<dd>
<p>A DSA signature value.</p>
</dd></dl>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-sysverify_source')" id="l_method-i-sysverify_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7b55c452b7d9a295d148ff882e0197cd139a9f8f/ext/openssl/lib/openssl/pkey.rb#L243" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-sysverify_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/ext/openssl/lib/openssl/pkey.rb, line 243</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sysverify</span>(<span class="ruby-identifier">digest</span>, <span class="ruby-identifier">sig</span>)
  <span class="ruby-identifier">verify_raw</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">sig</span>, <span class="ruby-identifier">digest</span>)
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">PKeyError</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">DSAError</span>, <span class="ruby-identifier">$!</span>.<span class="ruby-identifier">message</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-to_der">
            
              <b>dsa.to_der &rarr; aString
</b>
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-i-to_der" name="method-i-to_der" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Serializes a private or public key to a DER-encoding.</p>

<p>See <a href="DSA.html#method-i-to_pem"><code>to_pem</code></a> for details.</p>

<p><strong>This method is kept for compatibility.</strong> This should only be used when the traditional, non-standard OpenSSL format is required.</p>

<p>Consider using <a href="PKey.html#method-i-public_to_der"><code>public_to_der</code></a> or <a href="PKey.html#method-i-private_to_der"><code>private_to_der</code></a> instead.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-to_der_source')" id="l_method-i-to_der_source">show</a>
                
              </p>
              <div id="method-i-to_der_source" class="dyn-source">
                <pre>static VALUE
ossl_dsa_to_der(VALUE self)
{
    OSSL_3_const DSA *dsa;

    GetDSA(self, dsa);
    if (DSA_HAS_PRIVATE(dsa))
        return ossl_pkey_export_traditional(0, NULL, self, 1);
    else
        return ossl_pkey_export_spki(self, 1);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-to_pem">
            
              <b>dsa.to_pem([cipher, password]) &rarr; aString</b>
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-i-to_pem" name="method-i-to_pem" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Serializes a private or public key to a PEM-encoding.</p>
<dl class="rdoc-list label-list"><dt>When the key contains public components only
<dd>
<p>Serializes it into an X.509 SubjectPublicKeyInfo. The parameters <em>cipher</em> and <em>password</em> are ignored.</p>

<p>A PEM-encoded key will look like:</p>

<pre><code>-----BEGIN PUBLIC KEY-----
[...]
-----END PUBLIC KEY-----
</code></pre>

<p>Consider using <a href="PKey.html#method-i-public_to_pem"><code>public_to_pem</code></a> instead. This serializes the key into an X.509 SubjectPublicKeyInfo regardless of whether it is a public key or a private key.</p>
</dd><dt>When the key contains private components, and no parameters are given
<dd>
<p>Serializes it into a traditional OpenSSL DSAPrivateKey.</p>

<p>A PEM-encoded key will look like:</p>

<pre><code>-----BEGIN DSA PRIVATE KEY-----
[...]
-----END DSA PRIVATE KEY-----
</code></pre>
</dd><dt>When the key contains private components, and <em>cipher</em> and <em>password</em> are given
<dd>
<p>Serializes it into a traditional OpenSSL DSAPrivateKey and encrypts it in OpenSSL’s traditional PEM encryption format. <em>cipher</em> must be a cipher name understood by <a href="../Cipher.html#method-c-new"><code>OpenSSL::Cipher.new</code></a> or an instance of <a href="../Cipher.html"><code>OpenSSL::Cipher</code></a>.</p>

<p>An encrypted PEM-encoded key will look like:</p>

<pre><code>-----BEGIN DSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,733F5302505B34701FC41F5C0746E4C0

[...]
-----END DSA PRIVATE KEY-----
</code></pre>

<p>Note that this format uses MD5 to derive the encryption key, and hence will not be available on FIPS-compliant systems.</p>
</dd></dl>

<p><strong>This method is kept for compatibility.</strong> This should only be used when the traditional, non-standard OpenSSL format is required.</p>

<p>Consider using <a href="PKey.html#method-i-public_to_pem"><code>public_to_pem</code></a> (X.509 SubjectPublicKeyInfo) or <a href="PKey.html#method-i-private_to_pem"><code>private_to_pem</code></a> (PKCS #8 PrivateKeyInfo or EncryptedPrivateKeyInfo) instead.</p>
            </div>
          

          

          
            <div class="aka">
              Alias for: <a href="DSA.html#method-i-export">export</a>
            </div>
          

          
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-to_s">
            
              <b>dsa.to_s([cipher, password]) &rarr; aString</b>
            
            <a href="../../../classes/OpenSSL/PKey/DSA.html#method-i-to_s" name="method-i-to_s" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Serializes a private or public key to a PEM-encoding.</p>
<dl class="rdoc-list label-list"><dt>When the key contains public components only
<dd>
<p>Serializes it into an X.509 SubjectPublicKeyInfo. The parameters <em>cipher</em> and <em>password</em> are ignored.</p>

<p>A PEM-encoded key will look like:</p>

<pre><code>-----BEGIN PUBLIC KEY-----
[...]
-----END PUBLIC KEY-----
</code></pre>

<p>Consider using <a href="PKey.html#method-i-public_to_pem"><code>public_to_pem</code></a> instead. This serializes the key into an X.509 SubjectPublicKeyInfo regardless of whether it is a public key or a private key.</p>
</dd><dt>When the key contains private components, and no parameters are given
<dd>
<p>Serializes it into a traditional OpenSSL DSAPrivateKey.</p>

<p>A PEM-encoded key will look like:</p>

<pre><code>-----BEGIN DSA PRIVATE KEY-----
[...]
-----END DSA PRIVATE KEY-----
</code></pre>
</dd><dt>When the key contains private components, and <em>cipher</em> and <em>password</em> are given
<dd>
<p>Serializes it into a traditional OpenSSL DSAPrivateKey and encrypts it in OpenSSL’s traditional PEM encryption format. <em>cipher</em> must be a cipher name understood by <a href="../Cipher.html#method-c-new"><code>OpenSSL::Cipher.new</code></a> or an instance of <a href="../Cipher.html"><code>OpenSSL::Cipher</code></a>.</p>

<p>An encrypted PEM-encoded key will look like:</p>

<pre><code>-----BEGIN DSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,733F5302505B34701FC41F5C0746E4C0

[...]
-----END DSA PRIVATE KEY-----
</code></pre>

<p>Note that this format uses MD5 to derive the encryption key, and hence will not be available on FIPS-compliant systems.</p>
</dd></dl>

<p><strong>This method is kept for compatibility.</strong> This should only be used when the traditional, non-standard OpenSSL format is required.</p>

<p>Consider using <a href="PKey.html#method-i-public_to_pem"><code>public_to_pem</code></a> (X.509 SubjectPublicKeyInfo) or <a href="PKey.html#method-i-private_to_pem"><code>private_to_pem</code></a> (PKCS #8 PrivateKeyInfo or EncryptedPrivateKeyInfo) instead.</p>
            </div>
          

          

          
            <div class="aka">
              Alias for: <a href="DSA.html#method-i-export">export</a>
            </div>
          

          
          </div>
        
      
    
  
</div>

    </main>
  </body>
</html>
