<!DOCTYPE html>
<html lang="en">
<head>
    <title>ERB</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
<link rel="stylesheet" href="/css/reset.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/panel.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/main.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/github.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<script src="/js/jquery-3.5.1.min.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/main.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/highlight.pack.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/turbolinks.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/search_index.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/searcher.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/panel/tree.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/searchdoc.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>

<meta name="data-rel-prefix" content="/">
<meta name="data-tree-keys" content='["ERB"]'>


    <meta property="og:title" value="ERB">

  
    
    <meta name="description" content="ERB – Ruby Templating  Introduction  ERB provides an easy to use but powerful templating system for Ruby.">
    <meta property="og:description" content="ERB – Ruby Templating  Introduction  ERB provides an easy to use but powerful templating system for Ruby.">
  

    <meta name="keywords" content="ERB class, version, new, make_compiler, location=, set_eoutvar, run, result, result_with_hash, def_method, def_module, def_class">
</head>

<body>
    <a class="sr-only sr-only-focusable" href="#content" data-turbolinks="false">Skip to Content</a>
    <a class="sr-only sr-only-focusable" href="#search" data-turbolinks="false">Skip to Search</a>

    <input type="checkbox" id="hamburger" class="panel_checkbox">
<label class="panel_mobile_button" for="hamburger"><span></span> Menu</label>
<nav class="panel panel_tree" id="panel" data-turbolinks-permanent>
  <div class="header">
    <input type="text" placeholder="Search (/) for a class, method, ..." autosave="searchdoc" results="10" id="search" autocomplete="off" tabindex="-1" />
    <label class="panel_mobile_button_close" for="hamburger"><span></span> Close</label>
  </div>
  <div class="tree">
    <ul>
    </ul>
  </div>
  <div class="result">
    <ul>
    </ul>
  </div>
  <a href="links.html" id="links">index</a>
</nav>


    <div class="banner">
        
        <h2>
            <span class="type">Class</span>
            ERB
            
                <span class="parent">&lt;
                    
                    <a href="Object.html">Object</a>
                    
                </span>
            
        </h2>
        <ul class="files">
            
            <li><a href="../files/ruby/lib/erb_rb.html">ruby/lib/erb.rb</a></li>
            
        </ul>
    </div>

    <main id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<h1 id="class-ERB-label-ERB+--+Ruby+Templating"><a href="ERB.html"><code>ERB</code></a> – Ruby Templating</h1>

<h2 id="class-ERB-label-Introduction">Introduction</h2>

<p><a href="ERB.html"><code>ERB</code></a> provides an easy to use but powerful templating system for Ruby.  Using <a href="ERB.html"><code>ERB</code></a>, actual Ruby code can be added to any plain text document for the purposes of generating document information details and/or flow control.</p>

<p>A very simple example is this:</p>

<pre><code>require &#39;erb&#39;

x = 42
template = ERB.new &lt;&lt;-EOF
  The value of x is: &lt;%= x %&gt;
EOF
puts template.result(binding)
</code></pre>

<p><em>Prints:</em> The value of x is: 42</p>

<p>More complex examples are given below.</p>

<h2 id="class-ERB-label-Recognized+Tags">Recognized Tags</h2>

<p><a href="ERB.html"><code>ERB</code></a> recognizes certain tags in the provided template and converts them based on the rules below:</p>

<pre><code>&lt;% Ruby code -- inline with output %&gt;
&lt;%= Ruby expression -- replace with result %&gt;
&lt;%# comment -- ignored -- useful in testing %&gt;
% a line of Ruby code -- treated as &lt;% line %&gt; (optional -- see ERB.new)
%% replaced with % if first thing on a line and % processing is used
&lt;%% or %%&gt; -- replace with &lt;% or %&gt; respectively
</code></pre>

<p>All other text is passed through <a href="ERB.html"><code>ERB</code></a> filtering unchanged.</p>

<h2 id="class-ERB-label-Options">Options</h2>

<p>There are several settings you can change when you use ERB:</p>
<ul><li>
<p>the nature of the tags that are recognized;</p>
</li><li>
<p>the binding used to resolve local variables in the template.</p>
</li></ul>

<p>See the <a href="ERB.html#method-c-new"><code>ERB.new</code></a> and <a href="ERB.html#method-i-result"><code>ERB#result</code></a> methods for more detail.</p>

<h2 id="class-ERB-label-Character+encodings">Character encodings</h2>

<p><a href="ERB.html"><code>ERB</code></a> (or Ruby code generated by <a href="ERB.html"><code>ERB</code></a>) returns a string in the same character encoding as the input string.  When the input string has a magic comment, however, it returns a string in the encoding specified by the magic comment.</p>

<pre><code># -*- coding: utf-8 -*-
require &#39;erb&#39;

template = ERB.new &lt;&lt;EOF
&lt;%#-*- coding: Big5 -*-%&gt;
  \_\_ENCODING\_\_ is &lt;%= \_\_ENCODING\_\_ %&gt;.
EOF
puts template.result
</code></pre>

<p><em>Prints:</em> _<em>ENCODING</em>_ is Big5.</p>

<h2 id="class-ERB-label-Examples">Examples</h2>

<h3 id="class-ERB-label-Plain+Text">Plain Text</h3>

<p><a href="ERB.html"><code>ERB</code></a> is useful for any generic templating situation.  Note that in this example, we use the convenient “% at start of line” tag, and we quote the template literally with <code>%q{...}</code> to avoid trouble with the backslash.</p>

<pre><code>require &quot;erb&quot;

# Create template.
template = %q{
  From:  James Edward Gray II &lt;james@grayproductions.net&gt;
  To:  &lt;%= to %&gt;
  Subject:  Addressing Needs

  &lt;%= to[/\w+/] %&gt;:

  Just wanted to send a quick note assuring that your needs are being
  addressed.

  I want you to know that my team will keep working on the issues,
  especially:

  &lt;%# ignore numerous minor requests -- focus on priorities %&gt;
  % priorities.each do |priority|
    * &lt;%= priority %&gt;
  % end

  Thanks for your patience.

  James Edward Gray II
}.gsub(/^  /, &#39;&#39;)

message = ERB.new(template, trim_mode: &quot;%&lt;&gt;&quot;)

# Set up template data.
to = &quot;Community Spokesman &lt;spokesman@ruby_community.org&gt;&quot;
priorities = [ &quot;Run Ruby Quiz&quot;,
               &quot;Document Modules&quot;,
               &quot;Answer Questions on Ruby Talk&quot; ]

# Produce result.
email = message.result
puts email
</code></pre>

<p><em>Generates:</em></p>

<pre><code>From:  James Edward Gray II &lt;james@grayproductions.net&gt;
To:  Community Spokesman &lt;spokesman@ruby_community.org&gt;
Subject:  Addressing Needs

Community:

Just wanted to send a quick note assuring that your needs are being addressed.

I want you to know that my team will keep working on the issues, especially:

    * Run Ruby Quiz
    * Document Modules
    * Answer Questions on Ruby Talk

Thanks for your patience.

James Edward Gray II
</code></pre>

<h3 id="class-ERB-label-Ruby+in+HTML">Ruby in HTML</h3>

<p><a href="ERB.html"><code>ERB</code></a> is often used in <code>.rhtml</code> files (HTML with embedded Ruby).  Notice the need in this example to provide a special binding when the template is run, so that the instance variables in the Product object can be resolved.</p>

<pre><code>require &quot;erb&quot;

# Build template data class.
class Product
  def initialize( code, name, desc, cost )
    @code = code
    @name = name
    @desc = desc
    @cost = cost

    @features = [ ]
  end

  def add_feature( feature )
    @features &lt;&lt; feature
  end

  # Support templating of member data.
  def get_binding
    binding
  end

  # ...
end

# Create template.
template = %{
  &lt;html&gt;
    &lt;head&gt;&lt;title&gt;Ruby Toys -- &lt;%= @name %&gt;&lt;/title&gt;&lt;/head&gt;
    &lt;body&gt;

      &lt;h1&gt;&lt;%= @name %&gt; (&lt;%= @code %&gt;)&lt;/h1&gt;
      &lt;p&gt;&lt;%= @desc %&gt;&lt;/p&gt;

      &lt;ul&gt;
        &lt;% @features.each do |f| %&gt;
          &lt;li&gt;&lt;b&gt;&lt;%= f %&gt;&lt;/b&gt;&lt;/li&gt;
        &lt;% end %&gt;
      &lt;/ul&gt;

      &lt;p&gt;
        &lt;% if @cost &lt; 10 %&gt;
          &lt;b&gt;Only &lt;%= @cost %&gt;!!!&lt;/b&gt;
        &lt;% else %&gt;
           Call for a price, today!
        &lt;% end %&gt;
      &lt;/p&gt;

    &lt;/body&gt;
  &lt;/html&gt;
}.gsub(/^  /, &#39;&#39;)

rhtml = ERB.new(template)

# Set up template data.
toy = Product.new( &quot;TZ-1002&quot;,
                   &quot;Rubysapien&quot;,
                   &quot;Geek&#39;s Best Friend!  Responds to Ruby commands...&quot;,
                   999.95 )
toy.add_feature(&quot;Listens for verbal commands in the Ruby language!&quot;)
toy.add_feature(&quot;Ignores Perl, Java, and all C variants.&quot;)
toy.add_feature(&quot;Karate-Chop Action!!!&quot;)
toy.add_feature(&quot;Matz signature on left leg.&quot;)
toy.add_feature(&quot;Gem studded eyes... Rubies, of course!&quot;)

# Produce result.
rhtml.run(toy.get_binding)
</code></pre>

<p><em>Generates (some blank lines removed):</em></p>

<pre><code>&lt;html&gt;
  &lt;head&gt;&lt;title&gt;Ruby Toys -- Rubysapien&lt;/title&gt;&lt;/head&gt;
  &lt;body&gt;

    &lt;h1&gt;Rubysapien (TZ-1002)&lt;/h1&gt;
    &lt;p&gt;Geek&#39;s Best Friend!  Responds to Ruby commands...&lt;/p&gt;

    &lt;ul&gt;
        &lt;li&gt;&lt;b&gt;Listens for verbal commands in the Ruby language!&lt;/b&gt;&lt;/li&gt;
        &lt;li&gt;&lt;b&gt;Ignores Perl, Java, and all C variants.&lt;/b&gt;&lt;/li&gt;
        &lt;li&gt;&lt;b&gt;Karate-Chop Action!!!&lt;/b&gt;&lt;/li&gt;
        &lt;li&gt;&lt;b&gt;Matz signature on left leg.&lt;/b&gt;&lt;/li&gt;
        &lt;li&gt;&lt;b&gt;Gem studded eyes... Rubies, of course!&lt;/b&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;
         Call for a price, today!
    &lt;/p&gt;

  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h2 id="class-ERB-label-Notes">Notes</h2>

<p>There are a variety of templating solutions available in various Ruby projects. For example, <a href="RDoc.html"><code>RDoc</code></a>, distributed with Ruby, uses its own template engine, which can be reused elsewhere.</p>

<p>Other popular engines could be found in the corresponding <a href="https://www.ruby-toolbox.com/categories/template_engines">Category</a> of The Ruby Toolbox.</p>

    </div>
  


  


  
  


  
    <!-- Namespace -->
    <div class="sectiontitle">Namespace</div>
    <ul>
      
        <li>
          <span class="type">MODULE</span>
          <a href="ERB/DefMethod.html">ERB::DefMethod</a>
        </li>
      
        <li>
          <span class="type">MODULE</span>
          <a href="ERB/Util.html">ERB::Util</a>
        </li>
      
    </ul>
  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>D</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-def_class">def_class</a>,
              </li>
            
              
              <li>
                <a href="#method-i-def_method">def_method</a>,
              </li>
            
              
              <li>
                <a href="#method-i-def_module">def_module</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>L</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-location-3D">location=</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>M</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-make_compiler">make_compiler</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-result">result</a>,
              </li>
            
              
              <li>
                <a href="#method-i-result_with_hash">result_with_hash</a>,
              </li>
            
              
              <li>
                <a href="#method-i-run">run</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-set_eoutvar">set_eoutvar</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>V</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-version">version</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    
      <!-- Section attributes -->
      <h2 class="sectiontitle">Attributes</h2>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>encoding</td>
            <td class='attr-desc'><p>The encoding to eval</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>filename</td>
            <td class='attr-desc'><p>The optional <em>filename</em> argument passed to <a href="Kernel.html#method-i-eval"><code>Kernel#eval</code></a> when the <a href="ERB.html"><code>ERB</code></a> code is run</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>lineno</td>
            <td class='attr-desc'><p>The optional <em>lineno</em> argument passed to <a href="Kernel.html#method-i-eval"><code>Kernel#eval</code></a> when the <a href="ERB.html"><code>ERB</code></a> code is run</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>src</td>
            <td class='attr-desc'><p>The Ruby code generated by <a href="ERB.html"><code>ERB</code></a></p></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <h2 class="sectiontitle">Class Public methods</h2>
      
        <div class="method">
          <h3 class="title method-title" id="method-c-new">
            
              <b>new</b>(str, safe_level=NOT_GIVEN, legacy_trim_mode=NOT_GIVEN, legacy_eoutvar=NOT_GIVEN, trim_mode: nil, eoutvar: &#39;_erbout&#39;)
            
            <a href="../classes/ERB.html#method-c-new" name="method-c-new" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Constructs a new <a href="ERB.html"><code>ERB</code></a> object with the template specified in <em>str</em>.</p>

<p>An <a href="ERB.html"><code>ERB</code></a> object works by building a chunk of Ruby code that will output the completed template when run.</p>

<p>If <em>trim_mode</em> is passed a <a href="String.html"><code>String</code></a> containing one or more of the following modifiers, <a href="ERB.html"><code>ERB</code></a> will adjust its code generation as listed:</p>

<pre><code>%  enables Ruby code processing for lines beginning with %
&lt;&gt; omit newline for lines starting with &lt;% and ending in %&gt;
&gt;  omit newline for lines ending in %&gt;
-  omit blank lines ending in -%&gt;
</code></pre>

<p><em>eoutvar</em> can be used to set the name of the variable <a href="ERB.html"><code>ERB</code></a> will build up its output in.  This is useful when you need to run multiple <a href="ERB.html"><code>ERB</code></a> templates through the same binding and/or when you want to control where output ends up.  Pass the name of the variable to be used inside a <a href="String.html"><code>String</code></a>.</p>

<h3 id="method-c-new-label-Example">Example</h3>

<pre><code>require &quot;erb&quot;

# build data class
class Listings
  PRODUCT = { :name =&gt; &quot;Chicken Fried Steak&quot;,
              :desc =&gt; &quot;A well messages pattie, breaded and fried.&quot;,
              :cost =&gt; 9.95 }

  attr_reader :product, :price

  def initialize( product = &quot;&quot;, price = &quot;&quot; )
    @product = product
    @price = price
  end

  def build
    b = binding
    # create and run templates, filling member data variables
    ERB.new(&lt;&lt;-&#39;END_PRODUCT&#39;.gsub(/^\s+/, &quot;&quot;), trim_mode: &quot;&quot;, eoutvar: &quot;@product&quot;).result b
      &lt;%= PRODUCT[:name] %&gt;
      &lt;%= PRODUCT[:desc] %&gt;
    END_PRODUCT
    ERB.new(&lt;&lt;-&#39;END_PRICE&#39;.gsub(/^\s+/, &quot;&quot;), trim_mode: &quot;&quot;, eoutvar: &quot;@price&quot;).result b
      &lt;%= PRODUCT[:name] %&gt; -- &lt;%= PRODUCT[:cost] %&gt;
      &lt;%= PRODUCT[:desc] %&gt;
    END_PRICE
  end
end

# setup template data
listings = Listings.new
listings.build

puts listings.product + &quot;\n&quot; + listings.price
</code></pre>

<p><em>Generates</em></p>

<pre><code>Chicken Fried Steak
A well messages pattie, breaded and fried.

Chicken Fried Steak -- 9.95
A well messages pattie, breaded and fried.
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7ebc380bb431cce87a1b436d026cc8540008abf4/lib/erb.rb#L808" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/erb.rb, line 808</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">str</span>, <span class="ruby-identifier">safe_level</span>=<span class="ruby-constant">NOT_GIVEN</span>, <span class="ruby-identifier">legacy_trim_mode</span>=<span class="ruby-constant">NOT_GIVEN</span>, <span class="ruby-identifier">legacy_eoutvar</span>=<span class="ruby-constant">NOT_GIVEN</span>, <span class="ruby-value">trim_mode:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">eoutvar:</span> <span class="ruby-string">&#39;_erbout&#39;</span>)
  <span class="ruby-comment"># Complex initializer for $SAFE deprecation at [Feature #14256]. Use keyword arguments to pass trim_mode or eoutvar.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">safe_level</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">NOT_GIVEN</span>
    <span class="ruby-identifier">warn</span> <span class="ruby-string">&#39;Passing safe_level with the 2nd argument of ERB.new is deprecated. Do not use it, and specify other arguments as keyword arguments.&#39;</span>, <span class="ruby-value">uplevel:</span> <span class="ruby-value">1</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$VERBOSE</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-constant">ZERO_SAFE_LEVELS</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">safe_level</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">legacy_trim_mode</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">NOT_GIVEN</span>
    <span class="ruby-identifier">warn</span> <span class="ruby-string">&#39;Passing trim_mode with the 3rd argument of ERB.new is deprecated. Use keyword argument like ERB.new(str, trim_mode: ...) instead.&#39;</span>, <span class="ruby-value">uplevel:</span> <span class="ruby-value">1</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$VERBOSE</span>
    <span class="ruby-identifier">trim_mode</span> = <span class="ruby-identifier">legacy_trim_mode</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">legacy_eoutvar</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">NOT_GIVEN</span>
    <span class="ruby-identifier">warn</span> <span class="ruby-string">&#39;Passing eoutvar with the 4th argument of ERB.new is deprecated. Use keyword argument like ERB.new(str, eoutvar: ...) instead.&#39;</span>, <span class="ruby-value">uplevel:</span> <span class="ruby-value">1</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$VERBOSE</span>
    <span class="ruby-identifier">eoutvar</span> = <span class="ruby-identifier">legacy_eoutvar</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">compiler</span> = <span class="ruby-identifier">make_compiler</span>(<span class="ruby-identifier">trim_mode</span>)
  <span class="ruby-identifier">set_eoutvar</span>(<span class="ruby-identifier">compiler</span>, <span class="ruby-identifier">eoutvar</span>)
  <span class="ruby-ivar">@src</span>, <span class="ruby-ivar">@encoding</span>, <span class="ruby-ivar">@frozen_string</span> = <span class="ruby-operator">*</span><span class="ruby-identifier">compiler</span>.<span class="ruby-identifier">compile</span>(<span class="ruby-identifier">str</span>)
  <span class="ruby-ivar">@filename</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@lineno</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@_init</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">singleton_class</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-c-version">
            
              <b>version</b>()
            
            <a href="../classes/ERB.html#method-c-version" name="method-c-version" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Returns revision information for the erb.rb module.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-version_source')" id="l_method-c-version_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7ebc380bb431cce87a1b436d026cc8540008abf4/lib/erb.rb#L261" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-c-version_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/erb.rb, line 261</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">version</span>
  <span class="ruby-node">&quot;erb.rb [2.2.0 #{ERB::Revision.split[1]}]&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
      
    
      <h2 class="sectiontitle">Instance Public methods</h2>
      
        <div class="method">
          <h3 class="title method-title" id="method-i-def_class">
            
              <b>def_class</b>(superklass=Object, methodname=&#39;result&#39;)
            
            <a href="../classes/ERB.html#method-i-def_class" name="method-i-def_class" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Define unnamed class which has <em>methodname</em> as instance method, and return it.</p>

<p>example:</p>

<pre><code>class MyClass_
  def initialize(arg1, arg2)
    @arg1 = arg1;  @arg2 = arg2
  end
end
filename = &#39;example.rhtml&#39;  # @arg1 and @arg2 are used in example.rhtml
erb = ERB.new(File.read(filename))
erb.filename = filename
MyClass = erb.def_class(MyClass_, &#39;render()&#39;)
print MyClass.new(&#39;foo&#39;, 123).render()
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-def_class_source')" id="l_method-i-def_class_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7ebc380bb431cce87a1b436d026cc8540008abf4/lib/erb.rb#L976" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-def_class_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/erb.rb, line 976</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">def_class</span>(<span class="ruby-identifier">superklass</span>=<span class="ruby-constant">Object</span>, <span class="ruby-identifier">methodname</span>=<span class="ruby-string">&#39;result&#39;</span>)
  <span class="ruby-identifier">cls</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">superklass</span>)
  <span class="ruby-identifier">def_method</span>(<span class="ruby-identifier">cls</span>, <span class="ruby-identifier">methodname</span>, <span class="ruby-ivar">@filename</span> <span class="ruby-operator">||</span> <span class="ruby-string">&#39;(ERB)&#39;</span>)
  <span class="ruby-identifier">cls</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-def_method">
            
              <b>def_method</b>(mod, methodname, fname=&#39;(ERB)&#39;)
            
            <a href="../classes/ERB.html#method-i-def_method" name="method-i-def_method" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Define <em>methodname</em> as instance method of <em>mod</em> from compiled Ruby source.</p>

<p>example:</p>

<pre><code>filename = &#39;example.rhtml&#39;   # &#39;arg1&#39; and &#39;arg2&#39; are used in example.rhtml
erb = ERB.new(File.read(filename))
erb.def_method(MyClass, &#39;render(arg1, arg2)&#39;, filename)
print MyClass.new.render(&#39;foo&#39;, 123)
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-def_method_source')" id="l_method-i-def_method_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7ebc380bb431cce87a1b436d026cc8540008abf4/lib/erb.rb#L940" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-def_method_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/erb.rb, line 940</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">def_method</span>(<span class="ruby-identifier">mod</span>, <span class="ruby-identifier">methodname</span>, <span class="ruby-identifier">fname</span>=<span class="ruby-string">&#39;(ERB)&#39;</span>)
  <span class="ruby-identifier">src</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">src</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/^(?!#|$)/</span>) {<span class="ruby-node">&quot;def #{methodname}\n&quot;</span>} <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;\nend\n&quot;</span>
  <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">module_eval</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">eval</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">binding</span>, <span class="ruby-identifier">fname</span>, <span class="ruby-value">-1</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-def_module">
            
              <b>def_module</b>(methodname=&#39;erb&#39;)
            
            <a href="../classes/ERB.html#method-i-def_module" name="method-i-def_module" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Create unnamed module, define <em>methodname</em> as instance method of it, and return it.</p>

<p>example:</p>

<pre><code>filename = &#39;example.rhtml&#39;   # &#39;arg1&#39; and &#39;arg2&#39; are used in example.rhtml
erb = ERB.new(File.read(filename))
erb.filename = filename
MyModule = erb.def_module(&#39;render(arg1, arg2)&#39;)
class MyClass
  include MyModule
end
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-def_module_source')" id="l_method-i-def_module_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7ebc380bb431cce87a1b436d026cc8540008abf4/lib/erb.rb#L957" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-def_module_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/erb.rb, line 957</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">def_module</span>(<span class="ruby-identifier">methodname</span>=<span class="ruby-string">&#39;erb&#39;</span>)
  <span class="ruby-identifier">mod</span> = <span class="ruby-constant">Module</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">def_method</span>(<span class="ruby-identifier">mod</span>, <span class="ruby-identifier">methodname</span>, <span class="ruby-ivar">@filename</span> <span class="ruby-operator">||</span> <span class="ruby-string">&#39;(ERB)&#39;</span>)
  <span class="ruby-identifier">mod</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-location-3D">
            
              <b>location=</b>((filename, lineno))
            
            <a href="../classes/ERB.html#method-i-location-3D" name="method-i-location-3D" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Sets optional filename and line number that will be used in <a href="ERB.html"><code>ERB</code></a> code evaluation and error reporting. See also <a href="ERB.html#attribute-i-filename"><code>filename=</code></a> and <a href="ERB.html#attribute-i-lineno"><code>lineno=</code></a></p>

<pre><code>erb = ERB.new(&#39;&lt;%= some_x %&gt;&#39;)
erb.render
# undefined local variable or method `some_x&#39;
#   from (erb):1

erb.location = [&#39;file.erb&#39;, 3]
# All subsequent error reporting would use new location
erb.render
# undefined local variable or method `some_x&#39;
#   from file.erb:4
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-location-3D_source')" id="l_method-i-location-3D_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7ebc380bb431cce87a1b436d026cc8540008abf4/lib/erb.rb#L870" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-location-3D_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/erb.rb, line 870</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">location=</span>((<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">lineno</span>))
  <span class="ruby-ivar">@filename</span> = <span class="ruby-identifier">filename</span>
  <span class="ruby-ivar">@lineno</span> = <span class="ruby-identifier">lineno</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">lineno</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-make_compiler">
            
              <b>make_compiler</b>(trim_mode)
            
            <a href="../classes/ERB.html#method-i-make_compiler" name="method-i-make_compiler" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Creates a new compiler for <a href="ERB.html"><code>ERB</code></a>.  See ERB::Compiler.new for details</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-make_compiler_source')" id="l_method-i-make_compiler_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7ebc380bb431cce87a1b436d026cc8540008abf4/lib/erb.rb#L837" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-make_compiler_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/erb.rb, line 837</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">make_compiler</span>(<span class="ruby-identifier">trim_mode</span>)
  <span class="ruby-constant">ERB</span><span class="ruby-operator">::</span><span class="ruby-constant">Compiler</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">trim_mode</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-result">
            
              <b>result</b>(b=new_toplevel)
            
            <a href="../classes/ERB.html#method-i-result" name="method-i-result" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Executes the generated <a href="ERB.html"><code>ERB</code></a> code to produce a completed template, returning the results of that code.  (See <a href="ERB.html#method-c-new"><code>ERB::new</code></a> for details on how this process can be affected by <em>safe_level</em>.)</p>

<p><em>b</em> accepts a <a href="Binding.html"><code>Binding</code></a> object which is used to set the context of code evaluation.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-result_source')" id="l_method-i-result_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7ebc380bb431cce87a1b436d026cc8540008abf4/lib/erb.rb#L900" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-result_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/erb.rb, line 900</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">result</span>(<span class="ruby-identifier">b</span>=<span class="ruby-identifier">new_toplevel</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@_init</span>.<span class="ruby-identifier">equal?</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">singleton_class</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;not initialized&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">eval</span>(<span class="ruby-ivar">@src</span>, <span class="ruby-identifier">b</span>, (<span class="ruby-ivar">@filename</span> <span class="ruby-operator">||</span> <span class="ruby-string">&#39;(erb)&#39;</span>), <span class="ruby-ivar">@lineno</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-result_with_hash">
            
              <b>result_with_hash</b>(hash)
            
            <a href="../classes/ERB.html#method-i-result_with_hash" name="method-i-result_with_hash" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Render a template on a new toplevel binding with local variables specified by a <a href="Hash.html"><code>Hash</code></a> object.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-result_with_hash_source')" id="l_method-i-result_with_hash_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7ebc380bb431cce87a1b436d026cc8540008abf4/lib/erb.rb#L909" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-result_with_hash_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/erb.rb, line 909</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">result_with_hash</span>(<span class="ruby-identifier">hash</span>)
  <span class="ruby-identifier">b</span> = <span class="ruby-identifier">new_toplevel</span>(<span class="ruby-identifier">hash</span>.<span class="ruby-identifier">keys</span>)
  <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">b</span>.<span class="ruby-identifier">local_variable_set</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">result</span>(<span class="ruby-identifier">b</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-run">
            
              <b>run</b>(b=new_toplevel)
            
            <a href="../classes/ERB.html#method-i-run" name="method-i-run" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Generate results and print them. (see <a href="ERB.html#method-i-result"><code>ERB#result</code></a>)</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-run_source')" id="l_method-i-run_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7ebc380bb431cce87a1b436d026cc8540008abf4/lib/erb.rb#L888" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-run_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/erb.rb, line 888</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">run</span>(<span class="ruby-identifier">b</span>=<span class="ruby-identifier">new_toplevel</span>)
  <span class="ruby-identifier">print</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">result</span>(<span class="ruby-identifier">b</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <h3 class="title method-title" id="method-i-set_eoutvar">
            
              <b>set_eoutvar</b>(compiler, eoutvar = &#39;_erbout&#39;)
            
            <a href="../classes/ERB.html#method-i-set_eoutvar" name="method-i-set_eoutvar" class="permalink">Link</a>
          </h3>

          
            <div class="description">
              <p>Can be used to set <em>eoutvar</em> as described in <a href="ERB.html#method-c-new"><code>ERB::new</code></a>.  It’s probably easier to just use the constructor though, since calling this method requires the setup of an <a href="ERB.html"><code>ERB</code></a> <em>compiler</em> object.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-set_eoutvar_source')" id="l_method-i-set_eoutvar_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/7ebc380bb431cce87a1b436d026cc8540008abf4/lib/erb.rb#L880" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-set_eoutvar_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/erb.rb, line 880</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_eoutvar</span>(<span class="ruby-identifier">compiler</span>, <span class="ruby-identifier">eoutvar</span> = <span class="ruby-string">&#39;_erbout&#39;</span>)
  <span class="ruby-identifier">compiler</span>.<span class="ruby-identifier">put_cmd</span> = <span class="ruby-node">&quot;#{eoutvar}.&lt;&lt;&quot;</span>
  <span class="ruby-identifier">compiler</span>.<span class="ruby-identifier">insert_cmd</span> = <span class="ruby-node">&quot;#{eoutvar}.&lt;&lt;&quot;</span>
  <span class="ruby-identifier">compiler</span>.<span class="ruby-identifier">pre_cmd</span> = [<span class="ruby-node">&quot;#{eoutvar} = +&#39;&#39;&quot;</span>]
  <span class="ruby-identifier">compiler</span>.<span class="ruby-identifier">post_cmd</span> = [<span class="ruby-identifier">eoutvar</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
      
    
  
</div>

    </main>
  </body>
</html>
