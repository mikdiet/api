<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Rake::TestTask</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/github.css" type="text/css" media="screen" />
<script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            Rake::TestTask 
            
                <span class="parent">&lt; 
                    
                    <a href="TaskLib.html">Rake::TaskLib</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/ruby/lib/rake/testtask_rb.html">ruby/lib/rake/testtask.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>Create a task that runs a set of tests.</p>

<p>Example:</p>

<pre><code>Rake::TestTask.new do |t|
  t.libs &lt;&lt; &quot;test&quot;
  t.test_files = FileList[&#39;test/test*.rb&#39;]
  t.verbose = true
end
</code></pre>

<p>If rake is invoked with a “TEST=filename” command line option, then the
list of test files will be overridden to include only the filename
specified on the command line.  This provides an easy way to run just one
test.</p>

<p>If rake is invoked with a “TESTOPTS=options” command line option, then the
given options are passed to the test process after a &#39;–&#39;.  This
allows <a href="../Test/Unit.html">Test::Unit</a> options to be passed to
the test suite.</p>

<p>Examples:</p>

<pre><code>rake test                           # run tests normally
rake test TEST=just_one_file.rb     # run just one test file.
rake test TESTOPTS=&quot;-v&quot;             # run in verbose mode
rake test TESTOPTS=&quot;--runner=fox&quot;   # use the fox test runner</code></pre>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>D</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-define">define</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>F</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-file_list_string">file_list_string</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>L</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-lib_path">lib_path</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-ruby_opts_string">ruby_opts_string</a>,
              </li>
            
              
              <li>
                <a href="#method-i-ruby_version">ruby_version</a>,
              </li>
            
              
              <li>
                <a href="#method-i-run_code">run_code</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-test_files-3D">test_files=</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    
      <!-- Section attributes -->
      <div class="sectiontitle">Attributes</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>libs</td>
            <td class='attr-desc'><p>List of directories to added to $LOAD_PATH before running the tests.
(default is &#39;lib&#39;)</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>loader</td>
            <td class='attr-desc'><p>Style of test loader to use.  Options are:</p>
<ul><li>
<p>:rake – Rake provided test loading script (default).</p>
</li><li>
<p>:testrb – Ruby provided test loading script.</p>
</li><li>
<p>:direct – Load tests using command line loader.</p>
</li></ul></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>name</td>
            <td class='attr-desc'><p>Name of test task. (default is :test)</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>options</td>
            <td class='attr-desc'><p><a href="../Test.html">Test</a> options passed to the test suite.  An
explicit TESTOPTS=opts on the command line will override this. (default is
NONE)</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>pattern</td>
            <td class='attr-desc'><p>Glob pattern to match test files. (default is &#39;test/test*.rb&#39;)</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>ruby_opts</td>
            <td class='attr-desc'><p>Array of commandline options to pass to ruby when running test loader.</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>verbose</td>
            <td class='attr-desc'><p>True if verbose test output desired. (default is false)</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>warning</td>
            <td class='attr-desc'><p>Request that the tests be run with the warning flag set. E.g. warning=true
implies “ruby -w” used to run the tests.</p></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <b>new</b>(name=:test)
            
            <a href="../../classes/Rake/TestTask.html#method-c-new" name="method-c-new" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Create a testing task.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/1b023030a88a35118875b068a1fd725c58a32083/lib/rake/testtask.rb#L79" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/rake/testtask.rb, line 79</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">initialize</span>(<span class="ruby-identifier">name</span>=<span class="ruby-value">:test</span>)
  <span class="ruby-ivar">@name</span> = <span class="ruby-identifier">name</span>
  <span class="ruby-ivar">@libs</span> = [<span class="ruby-string">&quot;lib&quot;</span>]
  <span class="ruby-ivar">@pattern</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@options</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@test_files</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@verbose</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@warning</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@loader</span> = <span class="ruby-value">:rake</span>
  <span class="ruby-ivar">@ruby_opts</span> = []
  <span class="ruby-keyword">yield</span> <span class="ruby-keyword">self</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-ivar">@pattern</span> = <span class="ruby-string">&#39;test/test*.rb&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@pattern</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@test_files</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-identifier">define</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-define">
            
              <b>define</b>()
            
            <a href="../../classes/Rake/TestTask.html#method-i-define" name="method-i-define" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Create the tasks defined by this task lib.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-define_source')" id="l_method-i-define_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/1b023030a88a35118875b068a1fd725c58a32083/lib/rake/testtask.rb#L95" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-define_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/rake/testtask.rb, line 95</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">define</span>
  <span class="ruby-identifier">desc</span> <span class="ruby-string">&quot;Run tests&quot;</span> <span class="ruby-operator">+</span> (<span class="ruby-ivar">@name</span><span class="ruby-operator">==</span><span class="ruby-value">:test</span> <span class="ruby-operator">?</span> <span class="ruby-string">&quot;&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-node">&quot; for #{@name}&quot;</span>)
  <span class="ruby-identifier">task</span> <span class="ruby-ivar">@name</span> <span class="ruby-keyword">do</span>
    <span class="ruby-constant">FileUtilsExt</span>.<span class="ruby-identifier">verbose</span>(<span class="ruby-ivar">@verbose</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">args</span> = <span class="ruby-node">&quot;#{ruby_opts_string} #{run_code} #{file_list_string} #{option_list}&quot;</span>
      <span class="ruby-identifier">ruby</span> <span class="ruby-identifier">args</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ok</span>, <span class="ruby-identifier">status</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">ok</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">status</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:signaled?</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">status</span>.<span class="ruby-identifier">signaled?</span>
          <span class="ruby-identifier">raise</span> <span class="ruby-constant">SignalException</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">status</span>.<span class="ruby-identifier">termsig</span>)
        <span class="ruby-keyword">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">ok</span>
          <span class="ruby-identifier">fail</span> <span class="ruby-node">&quot;Command failed with status (#{status.exitstatus}): [ruby #{args}]&quot;</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-file_list_string">
            
              <b>file_list_string</b>()
            
            <a href="../../classes/Rake/TestTask.html#method-i-file_list_string" name="method-i-file_list_string" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-file_list_string_source')" id="l_method-i-file_list_string_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/1b023030a88a35118875b068a1fd725c58a32083/lib/rake/testtask.rb#L132" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-file_list_string_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/rake/testtask.rb, line 132</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">file_list_string</span>
  <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">fn</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;\&quot;#{fn}\&quot;&quot;</span> }.<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39; &#39;</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-lib_path">
            
              <b>lib_path</b>()
            
            <a href="../../classes/Rake/TestTask.html#method-i-lib_path" name="method-i-lib_path" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-lib_path_source')" id="l_method-i-lib_path_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/1b023030a88a35118875b068a1fd725c58a32083/lib/rake/testtask.rb#L128" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-lib_path_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/rake/testtask.rb, line 128</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">lib_path</span>
  <span class="ruby-ivar">@libs</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ruby_opts_string">
            
              <b>ruby_opts_string</b>()
            
            <a href="../../classes/Rake/TestTask.html#method-i-ruby_opts_string" name="method-i-ruby_opts_string" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ruby_opts_string_source')" id="l_method-i-ruby_opts_string_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/1b023030a88a35118875b068a1fd725c58a32083/lib/rake/testtask.rb#L121" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-ruby_opts_string_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/rake/testtask.rb, line 121</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">ruby_opts_string</span>
  <span class="ruby-identifier">opts</span> = <span class="ruby-ivar">@ruby_opts</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">unshift</span>( <span class="ruby-node">&quot;-I\&quot;#{lib_path}\&quot;&quot;</span> ) <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@libs</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">unshift</span>( <span class="ruby-string">&quot;-w&quot;</span> ) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@warning</span>
  <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot; &quot;</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ruby_version">
            
              <b>ruby_version</b>()
            
            <a href="../../classes/Rake/TestTask.html#method-i-ruby_version" name="method-i-ruby_version" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ruby_version_source')" id="l_method-i-ruby_version_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/1b023030a88a35118875b068a1fd725c58a32083/lib/rake/testtask.rb#L156" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-ruby_version_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/rake/testtask.rb, line 156</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">ruby_version</span>
  <span class="ruby-constant">RUBY_VERSION</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-run_code">
            
              <b>run_code</b>()
            
            <a href="../../classes/Rake/TestTask.html#method-i-run_code" name="method-i-run_code" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-run_code_source')" id="l_method-i-run_code_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/1b023030a88a35118875b068a1fd725c58a32083/lib/rake/testtask.rb#L160" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-run_code_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/rake/testtask.rb, line 160</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">run_code</span>
  <span class="ruby-keyword">case</span> <span class="ruby-ivar">@loader</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:direct</span>
    <span class="ruby-string">&quot;-e \&quot;ARGV.each{|f| require f}\&quot;&quot;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:testrb</span>
    <span class="ruby-node">&quot;-S testrb #{fix}&quot;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:rake</span>
    <span class="ruby-node">&quot;-I\&quot;#{rake_lib_dir}\&quot; \&quot;#{rake_loader}\&quot;&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_files-3D">
            
              <b>test_files=</b>(list)
            
            <a href="../../classes/Rake/TestTask.html#method-i-test_files-3D" name="method-i-test_files-3D" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Explicitly define the list of test files to be included in a test. 
<code>list</code> is expected to be an array of file names (a <a
href="FileList.html">FileList</a> is acceptable).  If both
<code>pattern</code> and <code>test_files</code> are used, then the list of
test files is the union of the two.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_files-3D_source')" id="l_method-i-test_files-3D_source">show</a>
                
                  | <a href="https://github.com/ruby/ruby/blob/1b023030a88a35118875b068a1fd725c58a32083/lib/rake/testtask.rb#L74" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_files-3D_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ruby/lib/rake/testtask.rb, line 74</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_files=</span>(<span class="ruby-identifier">list</span>)
  <span class="ruby-ivar">@test_files</span> = <span class="ruby-identifier">list</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>

    </div>
  </body>
</html>    