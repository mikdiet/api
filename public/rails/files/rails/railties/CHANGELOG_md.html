<!DOCTYPE html>
<html lang="en">
<head>
    <title>CHANGELOG.md</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
<link rel="stylesheet" href="/css/reset.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/panel.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/main.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/github.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<script src="/js/jquery-3.5.1.min.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/main.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/highlight.pack.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/turbolinks.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/search_index.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/searcher.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/panel/tree.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/searchdoc.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script type="text/javascript" charset="utf-8">
document.addEventListener("turbolinks:load", function() {
  // Only initialize panel if not yet initialized
  if(!$('#panel .tree ul li').length) {
    $('#links').hide();
    var panel = new Searchdoc.Panel($('#panel'), search_data, tree, '/');
    $('#search').focus();
    var s = window.location.search.match(/\?q=([^&]+)/);
    if (s) {
      s = decodeURIComponent(s[1]).replace(/\+/g, ' ');
      if (s.length > 0) {
        $('#search').val(s);
        panel.search(s, true);
      }
    }
    panel.toggle([]);
  }
})
</script>


</head>

<body>

    <input type="checkbox" id="hamburger" class="panel_checkbox">
<label class="panel_mobile_button" for="hamburger"><span></span> Menu</label>
<div class="panel panel_tree" id="panel" data-turbolinks-permanent>
  <div class="header">
    <input type="text" placeholder="Search for a class, method, ..." autosave="searchdoc" results="10" id="search" autocomplete="off" tabindex="-1" />
    <label class="panel_mobile_button_close" for="hamburger"><span></span> Close</label>
  </div>
  <div class="tree">
    <ul>
    </ul>
  </div>
  <div class="result">
    <ul>
    </ul>
  </div>
  <a href="links.html" id="links">index</a>
</div>


    <div class="banner">
        
        <h2>
            CHANGELOG.md
        </h2>
        <ul class="files">
            
            <li>
                rails/railties/CHANGELOG.md
                
                    <a href="https://github.com/rails/rails/blob/46274982bb14fa0ba0a8d22c80be8d7154385b96/railties/CHANGELOG.md" target="_blank" class="github_url">on GitHub</a>
                
            </li>
            <li>Last modified: 2022-04-14 01:17:56 +0300</li>
        </ul>
    </div>

    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<h2 id="label-Rails+6.1.5+-28March+09-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.5 (March 09, 2022)</h2>
<ul><li>
<p>In <code>zeitwerk</code> mode, setup the <code>once</code> autoloader first, and the <code>main</code> autoloader after it. This order plays better with shared namespaces.</p>

<p><em>Xavier Noria</em></p>
</li><li>
<p>Handle paths with spaces when editing credentials.</p>

<p><em>Alex Ghiculescu</em></p>
</li><li>
<p>Support Psych 4 when loading secrets.</p>

<p><em>Nat Morcos</em></p>
</li></ul>

<h2 id="label-Rails+6.1.4.7+-28March+08-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4.7 (March 08, 2022)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.4.6+-28February+11-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4.6 (February 11, 2022)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.4.5+-28February+11-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4.5 (February 11, 2022)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.4.4+-28December+15-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4.4 (December 15, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.4.3+-28December+14-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4.3 (December 14, 2021)</h2>
<ul><li>
<p>Allow localhost with a port by default in development</p>

<p>[Fixes: #43864]</p>
</li></ul>

<h2 id="label-Rails+6.1.4.2+-28December+14-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4.2 (December 14, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.4.1+-28August+19-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4.1 (August 19, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.4+-28June+24-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4 (June 24, 2021)</h2>
<ul><li>
<p>Fix compatibility with <code>psych &gt;= 4</code>.</p>

<p>Starting in Psych 4.0.0 <code>YAML.load</code> behaves like <code>YAML.safe_load</code>. To preserve compatibility <code>Rails.application.config_for</code> now uses <code>YAML.unsafe_load</code> if available.</p>

<p><em>Jean Boussier</em></p>
</li><li>
<p>Ensure <code>Rails.application.config_for</code> always cast hashes to <code>ActiveSupport::OrderedOptions</code>.</p>

<p><em>Jean Boussier</em></p>
</li><li>
<p>Fix create migration generator with <code>--pretend</code> option.</p>

<p><em>euxx</em></p>
</li></ul>

<h2 id="label-Rails+6.1.3.2+-28May+05-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.3.2 (May 05, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.3.1+-28March+26-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.3.1 (March 26, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.3+-28February+17-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.3 (February 17, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.2.1+-28February+10-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.2.1 (February 10, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.2+-28February+09-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.2 (February 09, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.1+-28January+07-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.1 (January 07, 2021)</h2>
<ul><li>
<p>Allow spaces in path to Yarn binstub and only run on precompile if needed.</p>

<p><em>Markus Doits</em></p>
</li><li>
<p>Populate ARGV for app template.</p>

<p>Fixes #40945.</p>

<p><em>Jonathan Hefner</em></p>
</li></ul>

<h2 id="label-Rails+6.1.0+-28December+09-2C+2020-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.0 (December 09, 2020)</h2>
<ul><li>
<p>Added <code>Railtie#server</code> hook called when <a href="../../../classes/Rails.html"><code>Rails</code></a> starts a server. This is useful in case your application or a library needs to run another process next to the <a href="../../../classes/Rails.html"><code>Rails</code></a> server. This is quite common in development for instance to run the Webpack or the React server.</p>

<p>It can be used like this:</p>

<pre><code>class MyRailtie &lt; Rails::Railtie
    server do
      WebpackServer.run
    end
  end
</code></pre>

<p><em>Edouard Chin</em></p>
</li><li>
<p>Remove deprecated <code>rake dev:cache</code> tasks.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated <code>rake routes</code> tasks.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated <code>rake initializers</code> tasks.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated support for using the <code>HOST</code> environment variable to specify the server IP.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated <code>server</code> argument from the rails server command.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated <code>SOURCE_ANNOTATION_DIRECTORIES</code> environment variable support from <code>rails notes</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated <code>connection</code> option in the <code>rails dbconsole</code> command.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove depreated <code>rake notes</code> tasks.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Return a 405 <a href="../../../classes/Method.html"><code>Method</code></a> Not Allowed response when a request uses an unknown HTTP method.</p>

<p>Fixes #38998.</p>

<p><em>Loren Norman</em></p>
</li><li>
<p>Make railsrc file location xdg-specification compliant</p>

<p><code>rails new</code> will now look for the default <code>railsrc</code> file at <code>$XDG_CONFIG_HOME/rails/railsrc</code> (or <code>~/.config/rails/railsrc</code> if <code>XDG_CONFIG_HOME</code> is not set). If this file does not exist, <code>rails new</code> will fall back to <code>~/.railsrc</code>.</p>

<p>The fallback behaviour means this does not cause any breaking changes.</p>

<p><em>Nick Wolf</em></p>
</li><li>
<p>Change the default logging level from :debug to :info to avoid inadvertent exposure of personally identifiable information (PII) in production environments.</p>

<p><em>Eric M. Payne</em></p>
</li><li>
<p>Automatically generate abstract class when using multiple databases.</p>

<p>When generating a scaffold for a multiple database application, <a href="../../../classes/Rails.html"><code>Rails</code></a> will now automatically generate the abstract class for the database when the database argument is passed. This abstract class will include the connection information for the writing configuration and any models generated for that database will automatically inherit from the abstract class.</p>

<p>Usage:</p>

<pre><code>$ bin/rails generate scaffold Pet name:string --database=animals
</code></pre>

<p>Will create an abstract class for the animals connection.</p>

<pre><code>class AnimalsRecord &lt; ApplicationRecord
  self.abstract_class = true

  connects_to database: { writing: :animals }
end
</code></pre>

<p>And generate a <code>Pet</code> model that inherits from the new <code>AnimalsRecord</code>:</p>

<pre><code>class Pet &lt; AnimalsRecord
end
</code></pre>

<p>If you already have an abstract class and it follows a different pattern than <a href="../../../classes/Rails.html"><code>Rails</code></a> defaults, you can pass a parent class with the database argument.</p>

<pre><code>$ bin/rails generate scaffold Pet name:string --database=animals --parent=SecondaryBase
</code></pre>

<p>This will ensure the model inherits from the <code>SecondaryBase</code> parent instead of <code>AnimalsRecord</code></p>

<pre><code>class Pet &lt; SecondaryBase
end
</code></pre>

<p><em>Eileen M. Uchitelle</em>, <em>John Crepezzi</em></p>
</li><li>
<p>Accept params from url to prepopulate the Inbound Emails form in <a href="../../../classes/Rails.html"><code>Rails</code></a> conductor.</p>

<p><em>Chris Oliver</em></p>
</li><li>
<p>Create a new rails app using a minimal stack.</p>

<p><code>rails new cool_app --minimal</code></p>

<p>All the following are excluded from your minimal stack:</p>
<ul><li>
<p>action_cable</p>
</li><li>
<p>action_mailbox</p>
</li><li>
<p>action_mailer</p>
</li><li>
<p>action_text</p>
</li><li>
<p>active_job</p>
</li><li>
<p>active_storage</p>
</li><li>
<p>bootsnap</p>
</li><li>
<p>jbuilder</p>
</li><li>
<p>spring</p>
</li><li>
<p>system_tests</p>
</li><li>
<p>turbolinks</p>
</li><li>
<p>webpack</p>
</li></ul>

<p><em>Haroon Ahmed</em>, <em>DHH</em></p>
</li><li>
<p>Add default ENV variable option with BACKTRACE to turn off backtrace cleaning when debugging framework code in the generated config/initializers/backtrace_silencers.rb.</p>

<p><code>BACKTRACE=1 ./bin/rails runner &quot;MyClass.perform&quot;</code></p>

<p><em>DHH</em></p>
</li><li>
<p>The autoloading guide for Zeitwerk mode documents how to autoload classes during application boot in a safe way.</p>

<p><em>Haroon Ahmed</em>, <em>Xavier Noria</em></p>
</li><li>
<p>The <code>classic</code> autoloader starts its deprecation cycle.</p>

<p>New <a href="../../../classes/Rails.html"><code>Rails</code></a> projects are strongly discouraged from using <code>classic</code>, and we recommend that existing projects running on <code>classic</code> switch to <code>zeitwerk</code> mode when upgrading. Please check the {<em>Upgrading Ruby on Rails</em><a href="https://guides.rubyonrails.org/upgrading_ruby_on_rails.html">}</a> guide for tips.</p>

<p><em>Xavier Noria</em></p>
</li><li>
<p>Adds <code>rails test:all</code> for running all tests in the test directory.</p>

<p>This runs all test files in the test directory, including system tests.</p>

<p><em>Niklas Häusele</em></p>
</li><li>
<p>Add <code>config.generators.after_generate</code> for processing to generated files.</p>

<p>Register a callback that will get called right after generators has finished.</p>

<p><em>Yuji Yaginuma</em></p>
</li><li>
<p>Make test file patterns configurable via Environment variables</p>

<p>This makes test file patterns configurable via two environment variables:  <code>DEFAULT_TEST</code>, to configure files to test, and <code>DEFAULT_TEST_EXCLUDE</code>, to configure files to exclude from testing.</p>

<p>These values were hardcoded before, which made it difficult to add new categories of tests that should not be executed by default (e.g: smoke tests).</p>

<p><em>Jorge Manrubia</em></p>
</li><li>
<p>No longer include <code>rake rdoc</code> task when generating plugins.</p>

<p>To generate docs, use the <code>rdoc lib</code> command instead.</p>

<p><em>Jonathan Hefner</em></p>
</li><li>
<p>Allow relative paths with trailing slashes to be passed to <code>rails test</code>.</p>

<p><em>Eugene Kenny</em></p>
</li><li>
<p>Add <code>rack-mini-profiler</code> gem to the default <code>Gemfile</code>.</p>

<p><code>rack-mini-profiler</code> displays performance information such as SQL time and flame graphs. It&#39;s enabled by default in development environment, but can be enabled in production as well. See the gem <a href="https://github_com/MiniProfiler/rack-mini-profiler/blob/master/README_md.html">README</a> for information on how to enable it in production.</p>

<p><em>Osama Sayegh</em></p>
</li><li>
<p><code>rails stats</code> will now count TypeScript files toward JavaScript stats.</p>

<p><em>Joshua Cody</em></p>
</li><li>
<p>Run <code>git init</code> when generating plugins.</p>

<p>Opt out with <code>--skip-git</code>.</p>

<p><em>OKURA Masafumi</em></p>
</li><li>
<p>Add benchmark generator.</p>

<p>Introduce benchmark generator to benchmark <a href="../../../classes/Rails.html"><code>Rails</code></a> applications.</p>

<p><code>rails generate benchmark opt_compare</code></p>

<p>This creates a benchmark file that uses {<code>benchmark-ips</code><a href="https://github.com/evanphx/benchmark-ips">}</a>. By default, two code blocks can be benchmarked using the <code>before</code> and <code>after</code> reports.</p>

<p>You can run the generated benchmark file using:  <code>ruby script/benchmarks/opt_compare.rb</code></p>

<p><em>Kevin Jalbert</em>, <em>Gannon McGibbon</em></p>
</li><li>
<p>Cache compiled view templates when running tests by default.</p>

<p>When generating a new app without <code>--skip-spring</code>, caching classes is disabled in <code>environments/test.rb</code>. This implicitly disables caching view templates too. This change will enable view template caching by adding this to the generated <code>environments/test.rb</code>:</p>

<pre><code>config.action_view.cache_template_loading = true
</code></pre>

<p><em>Jorge Manrubia</em></p>
</li><li>
<p>Introduce middleware move operations.</p>

<p>With this change, you no longer need to delete and reinsert a middleware to move it from one place to another in the stack:</p>

<pre><code>config.middleware.move_before ActionDispatch::Flash, Magical::Unicorns
</code></pre>

<p>This will move the <code>Magical::Unicorns</code> middleware before <code>ActionDispatch::Flash</code>. You can also move it after with:</p>

<pre><code>config.middleware.move_after ActionDispatch::Flash, Magical::Unicorns
</code></pre>

<p><em>Genadi Samokovarov</em></p>
</li><li>
<p>Generators that inherit from NamedBase respect <code>--force</code> option.</p>

<p><em>Josh Brody</em></p>
</li><li>
<p>Allow configuration of eager_load behaviour for rake environment:</p>

<pre><code>config.rake_eager_load
</code></pre>

<p>Defaults to <code>false</code> as per previous behaviour.</p>

<p><em>Thierry Joyal</em></p>
</li><li>
<p>Ensure <a href="../../../classes/Rails.html"><code>Rails</code></a> migration generator respects system-wide primary key config.</p>

<p>When rails is configured to use a specific primary key type:</p>

<pre><code>config.generators do |g|
  g.orm :active_record, primary_key_type: :uuid
end
</code></pre>

<p>Previously:</p>

<pre><code>$ bin/rails g migration add_location_to_users location:references
</code></pre>

<p>The references line in the migration would not have <code>type: :uuid</code>. This change causes the type to be applied appropriately.</p>

<p><em>Louis-Michel Couture</em>, <em>Dermot Haughey</em></p>
</li><li>
<p>Deprecate <code>Rails::DBConsole#config</code>.</p>

<p><code>Rails::DBConsole#config</code> is deprecated without replacement. Use <code>Rails::DBConsole.db_config.configuration_hash</code> instead.</p>

<p><em>Eileen M. Uchitelle</em>, <em>John Crepezzi</em></p>
</li><li>
<p><code>Rails.application.config_for</code> merges shared configuration deeply.</p>

<pre><code># config/example.yml
shared:
  foo:
    bar:
      baz: 1
development:
  foo:
    bar:
      qux: 2
</code></pre>

<pre><code># Previously
Rails.application.config_for(:example)[:foo][:bar] #=&gt; { qux: 2 }

# Now
Rails.application.config_for(:example)[:foo][:bar] #=&gt; { baz: 1, qux: 2 }
</code></pre>

<p><em>Yuhei Kiriyama</em></p>
</li><li>
<p>Remove access to values in nested hashes returned by <code>Rails.application.config_for</code> via <a href="../../../classes/String.html"><code>String</code></a> keys.</p>

<pre><code># config/example.yml
development:
  options:
    key: value
</code></pre>

<pre><code>Rails.application.config_for(:example).options
</code></pre>

<p>This used to return a <a href="../../../classes/Hash.html"><code>Hash</code></a> on which you could access values with <a href="../../../classes/String.html"><code>String</code></a> keys. This was deprecated in 6.0, and now doesn&#39;t work anymore.</p>

<p><em>Étienne Barrié</em></p>
</li><li>
<p>Configuration files for environments (<code>config/environments/*.rb</code>) are now able to modify <code>autoload_paths</code>, <code>autoload_once_paths</code>, and <code>eager_load_paths</code>.</p>

<p>As a consequence, applications cannot autoload within those files. Before, they technically could, but changes in autoloaded classes or modules had no effect anyway in the configuration because reloading does not reboot.</p>

<p>Ways to use application code in these files:</p>
<ul><li>
<p>Define early in the boot process a class that is not reloadable, from which the application takes configuration values that get passed to the framework.</p>

<pre><code># In config/application.rb, for example.
require &quot;#{Rails.root}/lib/my_app/config&quot;

# In config/environments/development.rb, for example.
config.foo = MyApp::Config.foo
</code></pre>
</li><li>
<p>If the class has to be reloadable, then wrap the configuration code in a <code>to_prepare</code> block:</p>

<pre><code>config.to_prepare do
  config.foo = MyModel.foo
end
</code></pre>
</li></ul>

<p>That assigns the latest <code>MyModel.foo</code> to <code>config.foo</code> when the application boots, and each time there is a reload. But whether that has an effect or not depends on the configuration point, since it is not uncommon for engines to read the application configuration during initialization and set their own state from them. That process happens only on boot, not on reloads, and if that is how <code>config.foo</code> worked, resetting it would have no effect in the state of the engine.</p>

<p><em>Allen Hsu</em> &amp; <em>Xavier Noria</em></p>
</li><li>
<p>Support using environment variable to set pidfile.</p>

<p><em>Ben Thorner</em></p>
</li></ul>

<p>Please check <a href="https://github_com/rails/rails/blob/6-0-stable/railties/CHANGELOG_md.html">6-0-stable</a> for previous changes.</p>

    </div>
  


  


  
  


  


  

  



  

    

    

    


    


    <!-- Methods -->
    
    
    
  
</div>

    </div>
  </body>
</html>
