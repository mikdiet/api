<!DOCTYPE html>
<html lang="en">
<head>
    <title>CHANGELOG.md</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
<link rel="stylesheet" href="/css/reset.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/panel.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/main.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<link rel="stylesheet" href="/css/github.css" type="text/css" media="screen" data-turbolinks-track="reload" />
<script src="/js/jquery-3.5.1.min.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/main.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/highlight.pack.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/turbolinks.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/search_index.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/searcher.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/panel/tree.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script src="/js/searchdoc.js" type="text/javascript" charset="utf-8" data-turbolinks-track="reload"></script>
<script type="text/javascript" charset="utf-8">
document.addEventListener("turbolinks:load", function() {
  // Only initialize panel if not yet initialized
  if(!$('#panel .tree ul li').length) {
    $('#links').hide();
    var panel = new Searchdoc.Panel($('#panel'), search_data, tree, '/');
    $('#search').focus();
    var s = window.location.search.match(/\?q=([^&]+)/);
    if (s) {
      s = decodeURIComponent(s[1]).replace(/\+/g, ' ');
      if (s.length > 0) {
        $('#search').val(s);
        panel.search(s, true);
      }
    }
    panel.toggle([]);
  }
})
</script>


</head>

<body>

    <input type="checkbox" id="hamburger" class="panel_checkbox">
<label class="panel_mobile_button" for="hamburger"><span></span> Menu</label>
<div class="panel panel_tree" id="panel" data-turbolinks-permanent>
  <div class="header">
    <input type="text" placeholder="Search for a class, method, ..." autosave="searchdoc" results="10" id="search" autocomplete="off" tabindex="-1" />
    <label class="panel_mobile_button_close" for="hamburger"><span></span> Close</label>
  </div>
  <div class="tree">
    <ul>
    </ul>
  </div>
  <div class="result">
    <ul>
    </ul>
  </div>
  <a href="links.html" id="links">index</a>
</div>


    <div class="banner">
        
        <h2>
            CHANGELOG.md
        </h2>
        <ul class="files">
            
            <li>
                rails/activesupport/CHANGELOG.md
                
                    <a href="https://github.com/rails/rails/blob/46274982bb14fa0ba0a8d22c80be8d7154385b96/activesupport/CHANGELOG.md" target="_blank" class="github_url">on GitHub</a>
                
            </li>
            <li>Last modified: 2022-04-14 01:17:56 +0300</li>
        </ul>
    </div>

    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<h2 id="label-Rails+6.1.5+-28March+09-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.5 (March 09, 2022)</h2>
<ul><li>
<p>Fix <code>ActiveSupport::Duration.build</code> to support negative values.</p>

<p>The algorithm to collect the <code>parts</code> of the <code>ActiveSupport::Duration</code> ignored the sign of the <code>value</code> and accumulated incorrect part values. This impacted <code>ActiveSupport::Duration#sum</code> (which is dependent on <code>parts</code>) but not <code>ActiveSupport::Duration#eql?</code> (which is dependent on <code>value</code>).</p>

<p><em>Caleb Buxton</em>, <em>Braden Staudacher</em></p>
</li><li>
<p><code>Time#change</code> and methods that call it (eg. <code>Time#advance</code>) will now return a <code>Time</code> with the timezone argument provided, if the caller was initialized with a timezone argument.</p>

<p>Fixes <a href="https://github.com/rails/rails/issues/42467">#42467</a>.</p>

<p><em>Alex Ghiculescu</em></p>
</li><li>
<p>Clone to keep extended Logger methods for tagged logger.</p>

<p><em>Orhan Toy</em></p>
</li><li>
<p><code>assert_changes</code> works on including <code>ActiveSupport::Assertions</code> module.</p>

<p><em>Pedro Medeiros</em></p>
</li></ul>

<h2 id="label-Rails+6.1.4.7+-28March+08-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4.7 (March 08, 2022)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.4.6+-28February+11-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4.6 (February 11, 2022)</h2>
<ul><li>
<p>Fix Reloader method signature to work with the new Executor signature</p>
</li></ul>

<h2 id="label-Rails+6.1.4.5+-28February+11-2C+2022-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4.5 (February 11, 2022)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.4.4+-28December+15-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4.4 (December 15, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.4.3+-28December+14-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4.3 (December 14, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.4.2+-28December+14-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4.2 (December 14, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.4.1+-28August+19-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4.1 (August 19, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.4+-28June+24-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.4 (June 24, 2021)</h2>
<ul><li>
<p>MemCacheStore: convert any underlying value (including <code>false</code>) to an <code>Entry</code>.</p>

<p>See <a href="https://github.com/rails/rails/pull/42559">#42559</a>.</p>

<p><em>Alex Ghiculescu</em></p>
</li><li>
<p>Fix bug in <code>number_with_precision</code> when using large <code>BigDecimal</code> values.</p>

<p>Fixes #42302.</p>

<p><em>Federico Aldunate</em>, <em>Zachary Scott</em></p>
</li><li>
<p>Check byte size instead of length on <code>secure_compare</code>.</p>

<p><em>Tietew</em></p>
</li><li>
<p>Fix <code>Time.at</code> to not lose <code>:in</code> option.</p>

<p><em>Ryuta Kamizono</em></p>
</li><li>
<p>Require a path for <code>config.cache_store = :file_store</code>.</p>

<p><em>Alex Ghiculescu</em></p>
</li><li>
<p>Avoid having to store complex object in the default translation file.</p>

<p><em>Rafael Mendonça França</em></p>
</li></ul>

<h2 id="label-Rails+6.1.3.2+-28May+05-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.3.2 (May 05, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.3.1+-28March+26-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.3.1 (March 26, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.3+-28February+17-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.3 (February 17, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.2.1+-28February+10-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.2.1 (February 10, 2021)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+6.1.2+-28February+09-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.2 (February 09, 2021)</h2>
<ul><li>
<p><code>ActiveSupport::Cache::MemCacheStore</code> now accepts an explicit <code>nil</code> for its <code>addresses</code> argument.</p>

<pre><code>config.cache_store = :mem_cache_store, nil

# is now equivalent to

config.cache_store = :mem_cache_store

# and is also equivalent to

config.cache_store = :mem_cache_store, ENV[&quot;MEMCACHE_SERVERS&quot;] || &quot;localhost:11211&quot;

# which is the fallback behavior of Dalli
</code></pre>

<p>This helps those migrating from <code>:dalli_store</code>, where an explicit <code>nil</code> was permitted.</p>

<p><em>Michael Overmeyer</em></p>
</li></ul>

<h2 id="label-Rails+6.1.1+-28January+07-2C+2021-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.1 (January 07, 2021)</h2>
<ul><li>
<p>Change <code>IPAddr#to_json</code> to match the behavior of the json gem returning the string representation instead of the instance variables of the object.</p>

<p>Before:</p>

<pre><code>IPAddr.new(&quot;127.0.0.1&quot;).to_json
# =&gt; &quot;{\&quot;addr\&quot;:2130706433,\&quot;family\&quot;:2,\&quot;mask_addr\&quot;:4294967295}&quot;
</code></pre>

<p>After:</p>

<pre><code>IPAddr.new(&quot;127.0.0.1&quot;).to_json
# =&gt; &quot;\&quot;127.0.0.1\&quot;&quot;
</code></pre>
</li></ul>

<h2 id="label-Rails+6.1.0+-28December+09-2C+2020-29"><a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1.0 (December 09, 2020)</h2>
<ul><li>
<p>Ensure <code>MemoryStore</code> disables compression by default. Reverts behavior of <code>MemoryStore</code> to its prior rails <code>5.1</code> behavior.</p>

<p><em>Max Gurewitz</em></p>
</li><li>
<p>Calling <code>iso8601</code> on negative durations retains the negative sign on individual digits instead of prepending it.</p>

<p>This change is required so we can interoperate with PostgreSQL, which prefers negative signs for each component.</p>

<p>Compatibility with other iso8601 parsers which support leading negatives as well as negatives per component is still retained.</p>

<p>Before:</p>

<pre><code>(-1.year - 1.day).iso8601
# =&gt; &quot;-P1Y1D&quot;
</code></pre>

<p>After:</p>

<pre><code>(-1.year - 1.day).iso8601
# =&gt; &quot;P-1Y-1D&quot;
</code></pre>

<p><em>Vipul A M</em></p>
</li><li>
<p>Remove deprecated <code>ActiveSupport::Notifications::Instrumenter#end=</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Deprecate <code>ActiveSupport::Multibyte::Unicode.default_normalization_form</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated <code>ActiveSupport::Multibyte::Unicode.pack_graphemes</code>, <code>ActiveSupport::Multibyte::Unicode.unpack_graphemes</code>, <code>ActiveSupport::Multibyte::Unicode.normalize</code>, <code>ActiveSupport::Multibyte::Unicode.downcase</code>, <code>ActiveSupport::Multibyte::Unicode.upcase</code> and <code>ActiveSupport::Multibyte::Unicode.swapcase</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated <code>ActiveSupport::Multibyte::Chars#consumes?</code> and <code>ActiveSupport::Multibyte::Chars#normalize</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated file <code>active_support/core_ext/range/include_range</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated file <code>active_support/core_ext/hash/transform_values</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated file <code>active_support/core_ext/hash/compact</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated file <code>active_support/core_ext/array/prepend_and_append</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated file <code>active_support/core_ext/numeric/inquiry</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated file <code>active_support/core_ext/module/reachable</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated <code>Module#parent_name</code>, <code>Module#parent</code> and <code>Module#parents</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated <code>ActiveSupport::LoggerThreadSafeLevel#after_initialize</code>.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated <code>LoggerSilence</code> constant.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove deprecated fallback to <code>I18n.default_local</code> when <code>config.i18n.fallbacks</code> is empty.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Remove entries from local cache on <code>RedisCacheStore#delete_matched</code></p>

<p>Fixes #38627</p>

<p><em>ojab</em></p>
</li><li>
<p>Speed up <code>ActiveSupport::SecurityUtils.fixed_length_secure_compare</code> by using <code>OpenSSL.fixed_length_secure_compare</code>, if available.</p>

<p><em>Nate Matykiewicz</em></p>
</li><li>
<p><code>ActiveSupport::Cache::MemCacheStore</code> now checks <code>ENV[&quot;MEMCACHE_SERVERS&quot;]</code> before falling back to <code>&quot;localhost:11211&quot;</code> if configured without any addresses.</p>

<pre><code>config.cache_store = :mem_cache_store

# is now equivalent to

config.cache_store = :mem_cache_store, ENV[&quot;MEMCACHE_SERVERS&quot;] || &quot;localhost:11211&quot;

# instead of

config.cache_store = :mem_cache_store, &quot;localhost:11211&quot; # ignores ENV[&quot;MEMCACHE_SERVERS&quot;]
</code></pre>

<p><em>Sam Bostock</em></p>
</li><li>
<p><code>ActiveSupport::Subscriber#attach_to</code> now accepts an <code>inherit_all:</code> argument. When set to true, it allows a subscriber to receive events for methods defined in the subscriber&#39;s ancestor class(es).</p>

<pre><code>class ActionControllerSubscriber &lt; ActiveSupport::Subscriber
  attach_to :action_controller

  def start_processing(event)
    info &quot;Processing by #{event.payload[:controller]}##{event.payload[:action]} as #{format}&quot;
  end

  def redirect_to(event)
    info { &quot;Redirected to #{event.payload[:location]}&quot; }
  end
end

# We detach ActionControllerSubscriber from the :action_controller namespace so that our CustomActionControllerSubscriber
# can provide its own instrumentation for certain events in the namespace
ActionControllerSubscriber.detach_from(:action_controller)

class CustomActionControllerSubscriber &lt; ActionControllerSubscriber
  attach_to :action_controller, inherit_all: true

  def start_processing(event)
    info &quot;A custom response to start_processing events&quot;
  end

  # =&gt; CustomActionControllerSubscriber will process events for &quot;start_processing.action_controller&quot; notifications
  # using its own #start_processing implementation, while retaining ActionControllerSubscriber&#39;s instrumentation
  # for &quot;redirect_to.action_controller&quot; notifications
end
</code></pre>

<p><em>Adrianna Chang</em></p>
</li><li>
<p>Allow the digest class used to generate non-sensitive digests to be configured with <code>config.active_support.hash_digest_class</code>.</p>

<p><code>config.active_support.use_sha1_digests</code> is deprecated in favour of <code>config.active_support.hash_digest_class = ::Digest::SHA1</code>.</p>

<p><em>Dirkjan Bussink</em></p>
</li><li>
<p>Fix bug to make memcached write_entry expire correctly with unless_exist</p>

<p><em>Jye Lee</em></p>
</li><li>
<p>Add <code>ActiveSupport::Duration</code> conversion methods</p>

<p><code>in_seconds</code>, <code>in_minutes</code>, <code>in_hours</code>, <code>in_days</code>, <code>in_weeks</code>, <code>in_months</code>, and <code>in_years</code> return the respective duration covered.</p>

<p><em>Jason York</em></p>
</li><li>
<p>Fixed issue in <code>ActiveSupport::Cache::RedisCacheStore</code> not passing options to <code>read_multi</code> causing <code>fetch_multi</code> to not work properly</p>

<p><em>Rajesh Sharma</em></p>
</li><li>
<p>Fixed issue in <code>ActiveSupport::Cache::MemCacheStore</code> which caused duplicate compression, and caused the provided <code>compression_threshold</code> to not be respected.</p>

<p><em>Max Gurewitz</em></p>
</li><li>
<p>Prevent <code>RedisCacheStore</code> and <code>MemCacheStore</code> from performing compression when reading entries written with <code>raw: true</code>.</p>

<p><em>Max Gurewitz</em></p>
</li><li>
<p><code>URI.parser</code> is deprecated and will be removed in <a href="../../../classes/Rails.html"><code>Rails</code></a> 7.0. Use <code>URI::DEFAULT_PARSER</code> instead.</p>

<p><em>Jean Boussier</em></p>
</li><li>
<p><code>require_dependency</code> has been documented to be <em>obsolete</em> in <code>:zeitwerk</code> mode. The method is not deprecated as such (yet), but applications are encouraged to not use it.</p>

<p>In <code>:zeitwerk</code> mode, semantics match Ruby&#39;s and you do not need to be defensive with load order. Just refer to classes and modules normally. If the constant name is dynamic, camelize if needed, and constantize.</p>

<p><em>Xavier Noria</em></p>
</li><li>
<p>Add 3rd person aliases of <code>Symbol#start_with?</code> and <code>Symbol#end_with?</code>.</p>

<pre><code>:foo.starts_with?(&quot;f&quot;) # =&gt; true
:foo.ends_with?(&quot;o&quot;)   # =&gt; true
</code></pre>

<p><em>Ryuta Kamizono</em></p>
</li><li>
<p>Add override of unary plus for <code>ActiveSupport::Duration</code>.</p>

<p><code>+ 1.second</code> is now identical to <code>+1.second</code> to prevent errors where a seemingly innocent change of formatting leads to a change in the code behavior.</p>

<p>Before:</p>

<pre><code>+1.second.class
# =&gt; ActiveSupport::Duration
(+ 1.second).class
# =&gt; Integer
</code></pre>

<p>After:</p>

<pre><code>+1.second.class
# =&gt; ActiveSupport::Duration
(+ 1.second).class
# =&gt; ActiveSupport::Duration
</code></pre>

<p>Fixes #39079.</p>

<p><em>Roman Kushnir</em></p>
</li><li>
<p>Add subsec to <code>ActiveSupport::TimeWithZone#inspect</code>.</p>

<p>Before:</p>

<pre><code>Time.at(1498099140).in_time_zone.inspect
# =&gt; &quot;Thu, 22 Jun 2017 02:39:00 UTC +00:00&quot;
Time.at(1498099140, 123456780, :nsec).in_time_zone.inspect
# =&gt; &quot;Thu, 22 Jun 2017 02:39:00 UTC +00:00&quot;
Time.at(1498099140 + Rational(&quot;1/3&quot;)).in_time_zone.inspect
# =&gt; &quot;Thu, 22 Jun 2017 02:39:00 UTC +00:00&quot;
</code></pre>

<p>After:</p>

<pre><code>Time.at(1498099140).in_time_zone.inspect
# =&gt; &quot;Thu, 22 Jun 2017 02:39:00.000000000 UTC +00:00&quot;
Time.at(1498099140, 123456780, :nsec).in_time_zone.inspect
# =&gt; &quot;Thu, 22 Jun 2017 02:39:00.123456780 UTC +00:00&quot;
Time.at(1498099140 + Rational(&quot;1/3&quot;)).in_time_zone.inspect
# =&gt; &quot;Thu, 22 Jun 2017 02:39:00.333333333 UTC +00:00&quot;
</code></pre>

<p><em>akinomaeni</em></p>
</li><li>
<p>Calling <code>ActiveSupport::TaggedLogging#tagged</code> without a block now returns a tagged logger.</p>

<pre><code>logger.tagged(&quot;BCX&quot;).info(&quot;Funky time!&quot;) # =&gt; [BCX] Funky time!
</code></pre>

<p><em>Eugene Kenny</em></p>
</li><li>
<p>Align <code>Range#cover?</code> extension behavior with Ruby behavior for backwards ranges.</p>

<p><code>(1..10).cover?(5..3)</code> now returns <code>false</code>, as it does in plain Ruby.</p>

<p>Also update <code>#include?</code> and <code>#===</code> behavior to match.</p>

<p><em>Michael Groeneman</em></p>
</li><li>
<p>Update to TZInfo v2.0.0.</p>

<p>This changes the output of <code>ActiveSupport::TimeZone.utc_to_local</code>, but can be controlled with the <code>ActiveSupport.utc_to_local_returns_utc_offset_times</code> config.</p>

<p>New <a href="../../../classes/Rails.html"><code>Rails</code></a> 6.1 apps have it enabled by default, existing apps can upgrade via the config in config/initializers/new_framework_defaults_6_1.rb</p>

<p>See the <code>utc_to_local_returns_utc_offset_times</code> documentation for details.</p>

<p><em>Phil Ross</em>, <em>Jared Beck</em></p>
</li><li>
<p>Add <a href="../../../classes/Date.html"><code>Date</code></a> and <a href="../../../classes/Time.html"><code>Time</code></a> <code>#yesterday?</code> and <code>#tomorrow?</code> alongside <code>#today?</code>.</p>

<p>Aliased to <code>#prev_day?</code> and <code>#next_day?</code> to match the existing <code>#prev/next_day</code> methods.</p>

<p><em>Jatin Dhankhar</em></p>
</li><li>
<p>Add <code>Enumerable#pick</code> to complement <code>ActiveRecord::Relation#pick</code>.</p>

<p><em>Eugene Kenny</em></p>
</li><li>
<p>[Breaking change] <code>ActiveSupport::Callbacks#halted_callback_hook</code> now receive a 2nd argument:</p>

<p><code>ActiveSupport::Callbacks#halted_callback_hook</code> now receive the name of the callback being halted as second argument. This change will allow you to differentiate which callbacks halted the chain and act accordingly.</p>

<pre><code>class Book &lt; ApplicationRecord
    before_save { throw(:abort) }
    before_create { throw(:abort) }

    def halted_callback_hook(filter, callback_name)
      Rails.logger.info(&quot;Book couldn&#39;t be #{callback_name}d&quot;)
    end

    Book.create # =&gt; &quot;Book couldn&#39;t be created&quot;
    book.save # =&gt; &quot;Book couldn&#39;t be saved&quot;
  end
</code></pre>

<p><em>Edouard Chin</em></p>
</li><li>
<p>Support <code>prepend</code> with <code>ActiveSupport::Concern</code>.</p>

<p>Allows a module with <code>extend ActiveSupport::Concern</code> to be prepended.</p>

<pre><code>module Imposter
  extend ActiveSupport::Concern

  # Same as `included`, except only run when prepended.
  prepended do
  end
end

class Person
  prepend Imposter
end
</code></pre>

<p><a href="../../../classes/Class.html"><code>Class</code></a> methods are prepended to the base class, concerning is also updated: <code>concerning :Imposter, prepend: true do</code>.</p>

<p><em>Jason Karns</em>, <em>Elia Schito</em></p>
</li><li>
<p>Deprecate using <code>Range#include?</code> method to check the inclusion of a value in a date time range. It is recommended to use <code>Range#cover?</code> method instead of <code>Range#include?</code> to check the inclusion of a value in a date time range.</p>

<p><em>Vishal Telangre</em></p>
</li><li>
<p>Support added for a <code>round_mode</code> parameter, in all number helpers. (See: <code>BigDecimal::mode</code>.)</p>

<pre><code>number_to_currency(1234567890.50, precision: 0, round_mode: :half_down) # =&gt; &quot;$1,234,567,890&quot;
number_to_percentage(302.24398923423, precision: 5, round_mode: :down) # =&gt; &quot;302.24398%&quot;
number_to_rounded(389.32314, precision: 0, round_mode: :ceil) # =&gt; &quot;390&quot;
number_to_human_size(483989, precision: 2, round_mode: :up) # =&gt; &quot;480 KB&quot;
number_to_human(489939, precision: 2, round_mode: :floor) # =&gt; &quot;480 Thousand&quot;

485000.to_s(:human, precision: 2, round_mode: :half_even) # =&gt; &quot;480 Thousand&quot;
</code></pre>

<p><em>Tom Lord</em></p>
</li><li>
<p><code>Array#to_sentence</code> no longer returns a frozen string.</p>

<p>Before:</p>

<pre><code>[&#39;one&#39;, &#39;two&#39;].to_sentence.frozen?
# =&gt; true
</code></pre>

<p>After:</p>

<pre><code>[&#39;one&#39;, &#39;two&#39;].to_sentence.frozen?
# =&gt; false
</code></pre>

<p><em>Nicolas Dular</em></p>
</li><li>
<p>When an instance of <code>ActiveSupport::Duration</code> is converted to an <code>iso8601</code> duration string, if <code>weeks</code> are mixed with <code>date</code> parts, the <code>week</code> part will be converted to days. This keeps the parser and serializer on the same page.</p>

<pre><code>duration = ActiveSupport::Duration.build(1000000)
# 1 week, 4 days, 13 hours, 46 minutes, and 40.0 seconds

duration_iso = duration.iso8601
# P11DT13H46M40S

ActiveSupport::Duration.parse(duration_iso)
# 11 days, 13 hours, 46 minutes, and 40 seconds

duration = ActiveSupport::Duration.build(604800)
# 1 week

duration_iso = duration.iso8601
# P1W

ActiveSupport::Duration.parse(duration_iso)
# 1 week
</code></pre>

<p><em>Abhishek Sarkar</em></p>
</li><li>
<p>Add block support to <code>ActiveSupport::Testing::TimeHelpers#travel_back</code>.</p>

<p><em>Tim Masliuchenko</em></p>
</li><li>
<p>Update <code>ActiveSupport::Messages::Metadata#fresh?</code> to work for cookies with expiry set when <code>ActiveSupport.parse_json_times = true</code>.</p>

<p><em>Christian Gregg</em></p>
</li><li>
<p>Support symbolic links for <code>content_path</code> in <code>ActiveSupport::EncryptedFile</code>.</p>

<p><em>Takumi Shotoku</em></p>
</li><li>
<p>Improve <code>Range#===</code>, <code>Range#include?</code>, and <code>Range#cover?</code> to work with beginless (startless) and endless range targets.</p>

<p><em>Allen Hsu</em>, <em>Andrew Hodgkinson</em></p>
</li><li>
<p>Don&#39;t use <code>Process#clock_gettime(CLOCK_THREAD_CPUTIME_ID)</code> on Solaris.</p>

<p><em>Iain Beeston</em></p>
</li><li>
<p>Prevent <code>ActiveSupport::Duration.build(value)</code> from creating instances of <code>ActiveSupport::Duration</code> unless <code>value</code> is of type <code>Numeric</code>.</p>

<p>Addresses the errant set of behaviours described in #37012 where <code>ActiveSupport::Duration</code> comparisons would fail confusingly or return unexpected results when comparing durations built from instances of <code>String</code>.</p>

<p>Before:</p>

<pre><code>small_duration_from_string = ActiveSupport::Duration.build(&#39;9&#39;)
large_duration_from_string = ActiveSupport::Duration.build(&#39;100000000000000&#39;)
small_duration_from_int = ActiveSupport::Duration.build(9)

large_duration_from_string &gt; small_duration_from_string
# =&gt; false

small_duration_from_string == small_duration_from_int
# =&gt; false

small_duration_from_int &lt; large_duration_from_string
# =&gt; ArgumentError (comparison of ActiveSupport::Duration::Scalar with ActiveSupport::Duration failed)

large_duration_from_string &gt; small_duration_from_int
# =&gt; ArgumentError (comparison of String with ActiveSupport::Duration failed)
</code></pre>

<p>After:</p>

<pre><code>small_duration_from_string = ActiveSupport::Duration.build(&#39;9&#39;)
# =&gt; TypeError (can&#39;t build an ActiveSupport::Duration from a String)
</code></pre>

<p><em>Alexei Emam</em></p>
</li><li>
<p>Add <code>ActiveSupport::Cache::Store#delete_multi</code> method to delete multiple keys from the cache store.</p>

<p><em>Peter Zhu</em></p>
</li><li>
<p>Support multiple arguments in <code>HashWithIndifferentAccess</code> for <code>merge</code> and <code>update</code> methods, to follow Ruby 2.6 addition.</p>

<p><em>Wojciech Wnętrzak</em></p>
</li><li>
<p>Allow initializing <code>thread_mattr_*</code> attributes via <code>:default</code> option.</p>

<pre><code>class Scraper
  thread_mattr_reader :client, default: Api::Client.new
end
</code></pre>

<p><em>Guilherme Mansur</em></p>
</li><li>
<p>Add <code>compact_blank</code> for those times when you want to remove blank? values from an <a href="../../../classes/Enumerable.html"><code>Enumerable</code></a> (also <code>compact_blank!</code> on <a href="../../../classes/Hash.html"><code>Hash</code></a>, <a href="../../../classes/Array.html"><code>Array</code></a>, <a href="../../../classes/ActionController/Parameters.html"><code>ActionController::Parameters</code></a>).</p>

<p><em>Dana Sherson</em></p>
</li><li>
<p>Make <a href="../../../classes/ActiveSupport/Logger.html"><code>ActiveSupport::Logger</code></a> Fiber-safe.</p>

<p>Use <code>Fiber.current.__id__</code> in <code>ActiveSupport::Logger#local_level=</code> in order to make log level local to Ruby Fibers in addition to Threads.</p>

<p>Example:</p>

<pre><code>logger = ActiveSupport::Logger.new(STDOUT)
logger.level = 1
puts &quot;Main is debug? #{logger.debug?}&quot;

Fiber.new {
  logger.local_level = 0
  puts &quot;Thread is debug? #{logger.debug?}&quot;
}.resume

puts &quot;Main is debug? #{logger.debug?}&quot;
</code></pre>

<p>Before:</p>

<pre><code>Main is debug? false
Thread is debug? true
Main is debug? true
</code></pre>

<p>After:</p>

<pre><code>Main is debug? false
Thread is debug? true
Main is debug? false
</code></pre>

<p>Fixes #36752.</p>

<p><em>Alexander Varnin</em></p>
</li><li>
<p>Allow the <code>on_rotation</code> proc used when decrypting/verifying a message to be passed at the constructor level.</p>

<p>Before:</p>

<pre><code>crypt = ActiveSupport::MessageEncryptor.new(&#39;long_secret&#39;)
crypt.decrypt_and_verify(encrypted_message, on_rotation: proc { ... })
crypt.decrypt_and_verify(another_encrypted_message, on_rotation: proc { ... })
</code></pre>

<p>After:</p>

<pre><code>crypt = ActiveSupport::MessageEncryptor.new(&#39;long_secret&#39;, on_rotation: proc { ... })
crypt.decrypt_and_verify(encrypted_message)
crypt.decrypt_and_verify(another_encrypted_message)
</code></pre>

<p><em>Edouard Chin</em></p>
</li><li>
<p><code>delegate_missing_to</code> would raise a <code>DelegationError</code> if the object delegated to was <code>nil</code>. Now the <code>allow_nil</code> option has been added to enable the user to specify they want <code>nil</code> returned in this case.</p>

<p><em>Matthew Tanous</em></p>
</li><li>
<p><code>truncate</code> would return the original string if it was too short to be truncated and a frozen string if it were long enough to be truncated. Now truncate will consistently return an unfrozen string regardless. This behavior is consistent with <code>gsub</code> and <code>strip</code>.</p>

<p>Before:</p>

<pre><code>&#39;foobar&#39;.truncate(5).frozen?
# =&gt; true
&#39;foobar&#39;.truncate(6).frozen?
# =&gt; false
</code></pre>

<p>After:</p>

<pre><code>&#39;foobar&#39;.truncate(5).frozen?
# =&gt; false
&#39;foobar&#39;.truncate(6).frozen?
# =&gt; false
</code></pre>

<p><em>Jordan Thomas</em></p>
</li></ul>

<p>Please check <a href="https://github_com/rails/rails/blob/6-0-stable/activesupport/CHANGELOG_md.html">6-0-stable</a> for previous changes.</p>

    </div>
  


  


  
  


  


  

  



  

    

    

    


    


    <!-- Methods -->
    
    
    
  
</div>

    </div>
  </body>
</html>
